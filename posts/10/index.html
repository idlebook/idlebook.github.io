<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="theme" content="Chirpy v2.7.2"><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="密码学的一些探索之数字签名" /><meta name="author" content="idlebook" /><meta property="og:locale" content="en_US" /><meta name="description" content="嗨，我是添书，一名 iOS 开发者,目前暂居深圳。" /><meta property="og:description" content="嗨，我是添书，一名 iOS 开发者,目前暂居深圳。" /><link rel="canonical" href="https://idlebook.github.io/posts/10/" /><meta property="og:url" content="https://idlebook.github.io/posts/10/" /><meta property="og:site_name" content="idlebook" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2019-08-02T00:00:00+08:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="密码学的一些探索之数字签名" /><meta name="twitter:site" content="@twitter_username" /><meta name="twitter:creator" content="@idlebook" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"description":"嗨，我是添书，一名 iOS 开发者,目前暂居深圳。","url":"https://idlebook.github.io/posts/10/","@type":"BlogPosting","headline":"密码学的一些探索之数字签名","dateModified":"2019-08-02T00:00:00+08:00","datePublished":"2019-08-02T00:00:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://idlebook.github.io/posts/10/"},"author":{"@type":"Person","name":"idlebook"},"@context":"https://schema.org"}</script><title>密码学的一些探索之数字签名 | idlebook</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="preload" href="/assets/css/post.css" as="style"><link rel="stylesheet" href="/assets/css/post.css"><link rel="preload" as="style" href="/assets/css/lib/bootstrap-toc.min.css"><link rel="stylesheet" href="/assets/css/lib/bootstrap-toc.min.css" /> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script async src="/assets/js/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/media/avatar.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">idlebook</a></div><div class="site-subtitle font-italic">但行好事,莫问前程</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/tabs/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>分类</span> </a><li class="nav-item"> <a href="/tabs/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>标签</span> </a><li class="nav-item"> <a href="/tabs/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>归档</span> </a><li class="nav-item"> <a href="/tabs/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>关于</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/github_username" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['example','doamin.com'].join('@')" aria-label="email" class="order-5" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-6" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> 主页 </a> </span> <span>密码学的一些探索之数字签名</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>密码学的一些探索之数字签名</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Fri, Aug 2, 2019, 12:00 AM +0800" > Aug 2, 2019 <i class="unloaded">2019-08-02T00:00:00+08:00</i> </span> by <span class="author"> idlebook </span></div><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="5684 words">31 min</span></div></div><div class="post-content"><p align="center"> <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://img.halfrost.com/Blog/ArticleImage/104_0.png" /></p><h2 id="一为什么需要数字签名">一、为什么需要数字签名？</h2><p>从上一篇文章里面我们知道，消息认证码可以识别篡改或者发送者身份是否被伪装，也就是验证消息的完整性，还可以对消息进行认证。但是消息认证码的缺陷就在于它的共享密钥上面。由于共享密钥的原因，导致无法防止抵赖。</p><p>数字签名就是为了解决抵赖的问题的。解决的方法就是让通信双方的共享密钥不同，从密钥上能区分出谁是谁。</p><h2 id="二什么是数字签名">二、什么是数字签名？</h2><p align="center"> <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://img.halfrost.com/Blog/ArticleImage/104_2.png" /></p><p>数字签名相当于现实世界中的盖章、签名的功能在计算机世界中进行实现的技术。数字签名可以识别篡改、伪装、防止抵赖。</p><p>在数字签名中，有 2 种行为：</p><ul><li>生成消息签名的行为<li>验证消息签名的行为</ul><p><strong>生成消息签名</strong>的人是由消息发送者完成的，也称为“对消息签名”。生成签名就是根据消息内容计算数字签名的值。</p><p><strong>验证数字签名</strong>的人是第三方。第三方验证消息的来源是否属于发送者。验证结果可以是成功，也可以是失败。</p><p><strong>数字签名对签名密钥和验证密钥进行了区分，使用验证密钥是无法生成签名的</strong>。签名密钥只能由签名人持有，而验证密钥则是任何需要验证签名的人都可以持有。</p><div class="table-wrapper"><table><thead><tr><th style="text-align: center"> <th style="text-align: center">私钥<th style="text-align: center">公钥<tbody><tr><td style="text-align: center">公钥密钥<td style="text-align: center">接收者解密时使用<td style="text-align: center">发送者加密时使用<tr><td style="text-align: center">数字签名<td style="text-align: center">签名者生成签名时使用<td style="text-align: center">验证者验证签名时使用<tr><td style="text-align: center">谁持有密钥？<td style="text-align: center">个人持有<td style="text-align: center">只要需要，任何人都可以持有</table></div><p>严格的来说，RSA 算法中公钥加密和数字签名正好是完全相反的关系，但是在其他公钥算法中有可能和数字签名不是完全相反的关系。</p><p align="center"> <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://img.halfrost.com/Blog/ArticleImage/104_3.png" /></p><p>在公钥算法中，公钥用来加密，私钥用来解密。</p><p align="center"> <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://img.halfrost.com/Blog/ArticleImage/104_4.png" /></p><p>在数字签名中，公钥用来解密(验证签名)，私钥用来加密(生成签名)。</p><h2 id="三生成和验证数字签名">三、生成和验证数字签名</h2><p align="center"> <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://img.halfrost.com/Blog/ArticleImage/104_5.png" /></p><p>有两种生成和验证数字签名的方法：</p><ul><li>直接对消息签名的方法<li>对消息的散列值签名的方法</ul><h3 id="1-直接对消息签名的方法">1. 直接对消息签名的方法</h3><p align="center"> <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://img.halfrost.com/Blog/ArticleImage/104_6.png" /></p><h3 id="2-对消息的散列值签名的方法">2. 对消息的散列值签名的方法</h3><p align="center"> <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://img.halfrost.com/Blog/ArticleImage/104_7.png" /></p><p>比较上面 2 种方法，一般都会使用第 2 种方法。原因是因为第 1 种方法要对整个消息进行加密，而且是公钥密钥算法，非常耗时。利用简短的单向散列函数来替代消息本身。再进行加密(对消息进行签名)，会快很多。</p><p>对上面的 2 种方法，有一些共性的问题进行解释：</p><ul><li>为什么加密以后的密文能够具备签名的意义？<ul><li>数字签名是利用了 “没有私钥的人就无法生成使用该私钥所生成的密文” 这一性质来实现的。生成的密文并非是用于保证机密性，而是用于代表一种<strong>只有持有该密钥的人才能生成的信息</strong>。所以私钥产生的密文是一种<strong>认证符号(authenticator)</strong>。</ul><li>上面方法 2 中消息没有加密就直接发送了，这样不就没法保证消息的机密性了么？<ul><li>数字签名本来就不保证消息的机密性。如果需要保证机密性，可以考虑加密和数字签名结合起来使用。</ul><li>签名可以随意复制么？<ul><li>数字签名代表的意义是<strong>特定的签名者与特定的消息绑定在一起</strong>，数字签名虽然可以任意复制，但是它的代表的意义始终不变。</ul><li>提取出签名，组合任意消息和该签名，这样不就可以伪造签名者的意图了吗？<ul><li>数字签名会识别修改，验证者验证的时候会发现消息和签名的散列值不同，验证失败从而丢弃这条消息。</ul><li>能否碰撞攻击，同时修改消息和签名，达到骗过验证者的目的？<ul><li>实际上这种方式做不到。首先修改了消息以后，散列值会发生变化。再想拼凑合法的签名，其实是做不到的。因为没有私钥是无法对新的散列值进行加密的。</ul><li>数字签名签订了以后能反悔么？<ul><li>数字签名本来就是用来防止抵赖的，一旦签署以后，无法抵赖，不能撕毁合同。只能再创建一个声明消息，声明该公钥已经作废的消息并另外加上数字签名。</ul></ul><h2 id="四数字签名应用实例">四、数字签名应用实例</h2><p align="center"> <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://img.halfrost.com/Blog/ArticleImage/104_1.png" /></p><h3 id="1-安全信息公告">1. 安全信息公告</h3><p>信息安全组织会在网站上发布一些关于安全漏洞的警告。由于这些信息需要被更多的人知道，所以没有必要对消息进行加密。但是需要防止有人伪装该组织发布虚假信息，这个时候只需要加上数字签名即可。这种对明文消息所施加的签名，一般称为<strong>明文签名(clearsign)</strong>。</p><p align="center"> <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://img.halfrost.com/Blog/ArticleImage/104_8.png" /></p><h3 id="2-软件下载">2. 软件下载</h3><p>为了保证下载软件的安全，不是恶意的病毒，软件作者会对软件加上数字签名。用户在下载完成以后，验证数字签名就能识别出下载的是不是被篡改过的软件。</p><h3 id="3-公钥证书">3. 公钥证书</h3><p>验证数字签名的时候需要合法的公钥，但是如何才能知道自己拿到的公钥是合法的呢？这个时候就需要把公钥作为信息，对它加上数字签名，得到公钥证书。关于证书的问题再下一篇文章里面详细分析。</p><h3 id="4-ssltls">4. SSL/TLS</h3><p>SSL/TLS 在认证服务器身份的时候会使用服务器证书，服务器证书就是加上了数字签名的服务器公钥。</p><h2 id="五数字签名的实现方式">五、数字签名的实现方式</h2><p align="center"> <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://img.halfrost.com/Blog/ArticleImage/104_9.png" /></p><p>这一章节简单的讲讲用 RSA 公钥算法和单向散列函数生成签名。</p><h3 id="1-用-rsa-生成签名">1. 用 RSA 生成签名</h3><div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="err">签名</span> <span class="o">=</span> <span class="err">消息</span><span class="o">^</span><span class="n">D</span> <span class="n">mod</span> <span class="n">N</span> <span class="p">(</span><span class="err">用</span> <span class="n">RSA</span> <span class="err">生成签名</span><span class="p">)</span>
</pre></table></code></div></div><p>上面的 D 和 N 就是签名者的私钥。签名就是对消息的 D 次方求 mod N 的结果。</p><h3 id="2-用-rsa-验证签名">2. 用 RSA 验证签名</h3><div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="err">由签名求得的消息</span> <span class="o">=</span> <span class="err">签名</span><span class="o">^</span><span class="n">E</span> <span class="n">mod</span> <span class="n">N</span> <span class="p">(</span><span class="err">用</span> <span class="n">RSA</span> <span class="err">验证签名</span><span class="p">)</span>
</pre></table></code></div></div><p>上面的 E 和 N 就是签名者的公钥。验证者计算签名的 E 次方并求 mod N，得到“由签名求得的消息”。将这个消息和发送者直接发过来的消息进行对比，如果一致就验证成功，不一致就验证失败。</p><h2 id="六其他几种数字签名">六、其他几种数字签名</h2><p align="center"> <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://img.halfrost.com/Blog/ArticleImage/104_10.png" /></p><h3 id="1-elgamal-方式">1. ElGamal 方式</h3><p>EIGamal 方式是由 Taher ElGamal 设计的公钥算法，利用了在 mod N 中求离散对数的困难度。ElGamal 方式可以被用于公钥密码和数字签名。</p><h3 id="2-dsa">2. DSA</h3><p>DSA(Digital Signature Algorithm)是一种数字签名的算法。是由 NIST(National Institute of Standards and Technology，美国国家标准技术研究所)于 1991 年制定的数字签名规范(Digital Signature Standard，DSS)。DSA 是 Schnorr 算法和 ElGamal 方式的变体，只能用于数字签名，不能进行加密解密。</p><p>和 DH 算法类似，DSA 算法主要了解的也是其参数。通过参数文件生成密钥对。p、q、g 是公共参数，通过参数会生成密钥对，DSA 的公共参数和 DH 的公共参数很像，通过公共参数能够生成无数个密钥对，这是一个很重要的特性。</p><p>p 是一个很大的质数，这个值的长度建议大于等于 1024 比特(必须是 64 比特的倍数)，p-1 必须是 q 的倍数，q 的长度必须是 160 比特。而 g 是一个数学表达式的结果，数值来自 p 和 q。</p><p>DSA算法中应用了下述参数：</p><p>p：L 比特长的素数。L 是 64 的倍数，范围是 512 到 1024；<br /> q：p – 1 的 160 比特的素因子；<br /> g：g = h^((p-1)/q) mod p，h 满足 h &lt; p – 1, h^((p-1)/q) mod p &gt; 1；<br /> x：x &lt; q，x 为私钥；<br /> y：y = g^x mod p ，( p, q, g, y )为公钥； <br /> H( x )：One-Way Hash函数。DSS 中 选用 SHA( Secure Hash Algorithm )。</p><p>DSA 的密钥对生成就取决于这三个公共参数 p、q、g。计算签名和验证签名也依赖参数文件。</p><h3 id="生成-dsa-密钥对">生成 DSA 密钥对</h3><ol><li>选取一个随机数作为私钥 x ，0 &lt; x &lt; q。<li>基于私钥生成公钥，g^x mod p</ol><blockquote><p>RSA 算法，DH 算法，DSA 算法都是基于离散数学。</p></blockquote><h3 id="签名生成">签名生成</h3><ol><li>生成一个随机数 k，1 &lt; k &lt; q。<li>计算 r = (g^k mod p) mod q。<li>计算 s = (k^(-1)(H(m)+xr)) mod q，H 是特定的摘要算法。<li>签名值就是(r，s)，随同原始消息 m 一起发送。</ol><h3 id="签名验证">签名验证</h3><ol><li>假如 r 和 s 大于 q 或者小于 0，则验证直接失败<li>计算 w = s^(-1) mod q<li>计算 u1 = H(m).w mod q<li>计算 u2 = r.w mod q<li>计算 v = (g^u1 * y^u2 mod p) mod q<li>如果 v 等于 r，则签名验证成功，否则失败</ol><h3 id="3-ecdsa">3. ECDSA</h3><p>ECDSA(Elliptic Curve Digital Signature Algorithm)是一种利用椭圆曲线密码来实现的数字签名算法。</p><p>就像 DH 算法结合 ECC 一样，DSA 算法也能结合 ECC，称为 ECDSA 数字签名算法。相比 DSA 算法，ECDSA 算法安全性更高。</p><p>在 ECDSA 中，有三个参数很重要：</p><ul><li>ECDSA 算法选择的命名曲线。<li>G，椭圆曲线的基点<li>n，相当于 G 基点的打点操作，n * G = 0</ul><h3 id="生成-ecdsa-密钥对">生成 ECDSA 密钥对</h3><ol><li>选择一个随机数作为私钥 d_{a}，1&lt; d_{a} &lt; n -1<li>基于私钥生成公钥，Q_{a} = d_{a} * G</ol><h3 id="签名生成-1">签名生成</h3><ol><li>计算摘要值 e = HASH(m)<li>获取 z = e 最左边的 L_{n} 位字符，L_{n} 是 n 的长度<li>生成一个随机数 k，1 &lt; k &lt; n - 1<li>计算 (x,y) = k * G<li>计算 r = x mod n<li>计算 s = k_{-1} (z + r * d_{-1}) mod n<li>签名值(r，s)</ol><h3 id="验证签名">验证签名</h3><ol><li>假如 r 和 s 小于 1 或者大于 n-1，验证直接失败<li>获取 z = e 最左边的 L_{n} 位字符<li>计算 w = s^{-1} mod n<li>计算 u_{1} = zw mod n<li>计算 u_{2} = rw mod n<li>计算 (x,y) = u_{1} * G + u_{2} * Q_{a}<li>如果 r == x_{1} mod n，则签名验证成功，否则失败</ol><h3 id="4-rabin-方式">4. Rabin 方式</h3><p>Rabin 方式是由 M.O.Rabin 设计的公钥算法，利用了在 mod N 中求平方根的困难度。Rabin 方式可以被用于公钥密码和数字签名。</p><h2 id="七对数字签名的攻击">七、对数字签名的攻击</h2><p align="center"> <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://img.halfrost.com/Blog/ArticleImage/104_11.png" /></p><h3 id="1-中间人攻击公钥">1. 中间人攻击公钥</h3><p>这里的攻击主要是攻击公钥。如何进行公钥之间的认证，还是需要使用公钥证书。</p><h3 id="2-对单向散列函数的攻击">2. 对单向散列函数的攻击</h3><p>对单向散列函数进行碰撞攻击，生成另外一条不同的消息，使其与签名所绑定的消息具有相同的散列值。</p><h3 id="3-利用数字签名攻击公钥密码">3. 利用数字签名攻击公钥密码</h3><p>由于 RSA 和数字签名互为逆向操作。于是可以利用这一性质，对 RSA 进行攻击。让发送者对 RSA 密文进行签名(用私钥加密)，就相当于是 RSA 中的解密操作。</p><p>防止这种攻击有几种方法：</p><ul><li>不要直接对任何消息进行签名，对散列值进行签名比较安全<li>公钥密码和数字签名使用不同的密钥对<li>绝对不要对意思不清楚的消息进行签名，就像在看不懂的合同上任意盖章</ul><h3 id="4-潜在伪造">4. 潜在伪造</h3><p>即使签名的对象是无任何意义的消息，例如随机比特序列，如果攻击者能够生成合法的数字签名(即攻击者生成的签名能够正常通过校验)，这也算是对这种签名算法的一种潜在威胁。在用 RSA 来解密消息的数字签名算法中，潜在伪造是可能的。只要将随机比特序列 S 用 RSA 的公钥加密生成密文 M，那么，S 就是 M 的合法数字签名，由于攻击者是可以获取公钥的，因此对数字签名的潜在伪造就实现了。</p><p>为了防止这种情况，人们改良了 RSA ，开发出了新的签名算法，RSA-PSS(Probabilistic Signature Scheme)。RSA-PSS 并不是对消息本身进行签名，而是对其散列值进行签名，为了提高安全性，在计算散列值的时候还对消息加盐(salt)。</p><h3 id="5-其他攻击">5. 其他攻击</h3><p>对公钥密码的攻击都可以用于对数字签名的攻击，例如暴力破解私钥，尝试对 RSA 的 N 进行质因数分解等等</p><h2 id="八数字签名无法解决的问题">八、数字签名无法解决的问题</h2><p>数字签名所用到的公钥密码中的公钥需要另外认证，防止中间人攻击。认证用于验证签名的公钥必须属于真正的发送者。</p><p>似乎陷入了一个死循环。数字签名用来识别消息篡改，伪装以及防止抵赖。但是我们又必须从没有被伪装的发送者得到没有被篡改的公钥才行。</p><p>为了验证得到的公钥是否合法，必须使用<strong>证书</strong>。证书是将公钥当做一条消息，由一个可信的第三方对其签名后所得到的公钥。</p><p>关于证书的话题，下一篇文章再继续展开。</p><h2 id="九openssl-中的-rsa-数字签名">九、OpenSSL 中的 RSA 数字签名</h2><p>和 RSA 公钥加密不一样，RSA 实现的数字签名技术需要涉及到摘要计算，所以需要指定 一个 Hash 算法。下面这个例子用 sha256 Hash 算法。</p><div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="c1">// 生成一个 RSA 密钥对，密钥长度 1024 长度</span>
<span class="err">$</span> <span class="n">openssl</span> <span class="n">genrsa</span> <span class="o">-</span><span class="n">out</span> <span class="n">rsaprivatekey</span><span class="p">.</span><span class="n">pem</span> <span class="mi">1024</span>
</pre></table></code></div></div><p>输出</p><div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre>
<span class="n">Generating</span> <span class="n">RSA</span> <span class="n">private</span> <span class="n">key</span><span class="p">,</span> <span class="mi">1024</span> <span class="n">bit</span> <span class="kt">long</span> <span class="n">modulus</span> <span class="p">(</span><span class="mi">2</span> <span class="n">primes</span><span class="p">)</span>
<span class="p">......</span><span class="o">++++++</span>
<span class="p">.............................................</span><span class="o">++++++</span>
<span class="n">e</span> <span class="n">is</span> <span class="mi">65537</span> <span class="p">(</span><span class="mh">0x010001</span><span class="p">)</span>

<span class="o">-----</span><span class="n">BEGIN</span> <span class="n">RSA</span> <span class="n">PRIVATE</span> <span class="n">KEY</span><span class="o">-----</span>
<span class="n">MIICXgIBAAKBgQDbaFOaGiDqwRe</span><span class="o">+</span><span class="n">nye9lmLy6mnQT33GGjV</span><span class="o">+</span><span class="n">vEDtTP</span><span class="o">/</span><span class="n">kog3W5jou</span>
<span class="n">LKduc7Qy</span><span class="o">/</span><span class="n">iMDXxVyAddaUjRwkuX6mdVOtDzgbBY</span><span class="o">/</span><span class="n">nwOSwvTe9jCD89AM7z0il6iG</span>
<span class="mi">7</span><span class="n">m1JgEEq9zYzmRxO</span><span class="o">/</span><span class="n">yfkv8OrlZpfZ6</span><span class="o">/</span><span class="mi">1</span><span class="n">jzUKVnjXlGdhkipJqBX19M9</span><span class="o">/</span><span class="n">kQIDAQAB</span>
<span class="n">AoGBAM2st6oe0jqeNd8InR1ZK3qhif2vdqzNBta</span><span class="o">+</span><span class="n">LHMHGl4</span><span class="o">+</span><span class="n">F5EbEvEUBQRCTGr8</span>
<span class="mi">1</span><span class="n">t</span><span class="o">+</span><span class="n">jM5xC45iUtPnOiu3nZRE5XlIaGbsklPM3chu0</span><span class="o">/</span><span class="n">onBdbXsP5aRSZuIobHP01GV</span>
<span class="n">LFqUsFmVOIAKPONRR8Zn5Ji9FQ5bs6meYBmawC23EWcB</span><span class="o">/</span><span class="n">cHRAkEA9AwOFZrIN3XG</span>
<span class="mi">0</span><span class="n">YXkoLTm0eGOWg6zRBUxt9ZwCjhciz</span><span class="o">/</span><span class="n">riDWnBqIwHxqourN4ss</span><span class="o">/</span><span class="n">XwyPJxmvYXMoW</span>
<span class="mi">2</span><span class="n">dl1KmjYBQJBAOYnVRWMraQSdbeSwTo27tGVME3I6RqJHrs0</span><span class="o">+</span><span class="mi">4</span><span class="n">EDH</span><span class="o">/</span><span class="n">W79bL778fJ</span>
<span class="n">VMRyTjKhZxbzb7xU0bl9it8rbxN</span><span class="o">+</span><span class="mi">4</span><span class="n">yjUmx0CQQC31zDw83Vp2e4Yve05Zq0OZASR</span>
<span class="n">MMu4OOMIIqCqAkUsnM04AXq</span><span class="o">+</span><span class="n">E4V</span><span class="o">+</span><span class="n">mN2ML1B4GvvlQ1tnfqwxUgceuqJ5fRtlAkAN</span>
<span class="n">ouj0pOgo33sgDE7sjxKpUkiRY0UEcHlkqCf6pd</span><span class="o">+/</span><span class="mi">5</span><span class="n">IoTN8AmOzSNiyQ89bkw7</span><span class="o">+</span><span class="mi">1</span><span class="o">/</span>
<span class="mi">4</span><span class="n">Bqo</span><span class="o">/</span><span class="n">do7jMxBAHSfF7G1AkEAsAx6</span><span class="o">+</span><span class="n">LSQHRN8iD1Uno9</span><span class="o">/</span><span class="n">VJXkoXV5CMicZIO4OXYT</span>
<span class="o">+</span><span class="n">z95tcREHgHRX4TmtF4Z9fTX5uQsk8oLgHqG9p4Y</span><span class="o">+</span><span class="n">RfJXw</span><span class="o">==</span>
<span class="o">-----</span><span class="n">END</span> <span class="n">RSA</span> <span class="n">PRIVATE</span> <span class="n">KEY</span><span class="o">-----</span>
</pre></table></code></div></div><p>提取公钥</p><div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="c1">// 从密钥对中分离出公钥</span>
<span class="err">$</span> <span class="n">openssl</span> <span class="n">rsa</span> <span class="o">-</span><span class="n">in</span> <span class="n">rsaprivatekey</span><span class="p">.</span><span class="n">pem</span> <span class="o">-</span><span class="n">pubout</span> <span class="o">-</span><span class="n">out</span> <span class="n">rsapublickey</span><span class="p">.</span><span class="n">pem</span>  
</pre></table></code></div></div><p>输出</p><div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="o">-----</span><span class="n">BEGIN</span> <span class="n">PUBLIC</span> <span class="n">KEY</span><span class="o">-----</span>
<span class="n">MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDbaFOaGiDqwRe</span><span class="o">+</span><span class="n">nye9lmLy6mnQ</span>
<span class="n">T33GGjV</span><span class="o">+</span><span class="n">vEDtTP</span><span class="o">/</span><span class="n">kog3W5jouLKduc7Qy</span><span class="o">/</span><span class="n">iMDXxVyAddaUjRwkuX6mdVOtDzgbBY</span><span class="o">/</span>
<span class="n">nwOSwvTe9jCD89AM7z0il6iG7m1JgEEq9zYzmRxO</span><span class="o">/</span><span class="n">yfkv8OrlZpfZ6</span><span class="o">/</span><span class="mi">1</span><span class="n">jzUKVnjX</span>
<span class="n">lGdhkipJqBX19M9</span><span class="o">/</span><span class="n">kQIDAQAB</span>
<span class="o">-----</span><span class="n">END</span> <span class="n">PUBLIC</span> <span class="n">KEY</span><span class="o">-----</span>
</pre></table></code></div></div><p>生成签名文件</p><div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="c1">// 对 plain.txt 文件使用 sha256 Hash 算法和签名算法生成签名文件 signature.txt </span>

<span class="err">$</span> <span class="n">echo</span> <span class="s">"hello"</span> <span class="o">&gt;&gt;</span> <span class="n">plain</span><span class="p">.</span><span class="n">txt</span>
<span class="err">$</span> <span class="n">openssl</span> <span class="n">dgst</span> <span class="o">-</span><span class="n">sha256</span> <span class="o">-</span><span class="n">sign</span> <span class="n">rsaprivatekey</span><span class="p">.</span><span class="n">pem</span> <span class="o">-</span><span class="n">out</span> <span class="n">signature</span><span class="p">.</span><span class="n">txt</span> <span class="n">plain</span><span class="p">.</span><span class="n">txt</span>

</pre></table></code></div></div><p>打开 signature.txt 文件，里面存储的就是签名之后的结果。</p><div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">l</span><span class="o">^</span><span class="n">C</span><span class="err">ãî</span><span class="n">E</span><span class="o">&lt;</span><span class="mi">9</span><span class="n">c</span><span class="o">&gt;&lt;</span><span class="mi">9</span><span class="n">f</span><span class="o">&gt;&gt;</span><span class="mi">3</span><span class="o">^</span><span class="n">M</span><span class="o">^?&amp;</span><span class="n">v</span><span class="p">{</span><span class="mi">7</span><span class="n">P</span><span class="err">`</span><span class="o">&lt;</span><span class="mi">91</span><span class="o">&gt;</span><span class="err"> </span><span class="o">&lt;</span><span class="mi">9</span><span class="n">c</span><span class="o">&gt;</span><span class="mi">55</span><span class="n">g</span><span class="o">^</span><span class="n">E</span><span class="o">^</span><span class="err">@Ç¦È</span><span class="n">Y</span><span class="err">þ</span> <span class="n">_</span><span class="err">Ï</span><span class="n">c</span><span class="err">`</span><span class="o">=</span><span class="err">ÓçÖÄ</span><span class="o">^</span><span class="p">[</span><span class="o">^</span><span class="n">C</span><span class="err">¢</span><span class="o">^</span><span class="n">MgO</span><span class="err">ÕÂ</span><span class="o">|^^</span><span class="err">»ÿ</span><span class="o">%</span><span class="err">ä</span><span class="o">:&lt;</span><span class="mi">92</span><span class="o">&gt;&lt;</span><span class="mi">8</span><span class="n">a</span><span class="o">&gt;</span><span class="err">÷</span><span class="o">&lt;</span><span class="mi">87</span><span class="o">&gt;</span><span class="n">f</span><span class="o">&lt;</span><span class="mi">89</span><span class="o">&gt;^</span><span class="n">M</span><span class="p">.</span>
<span class="err">¢</span><span class="n">aO</span><span class="o">&lt;</span><span class="mi">93</span><span class="o">&gt;</span><span class="err">ÕÇÝ</span><span class="o">&amp;</span><span class="n">x</span><span class="err">å</span><span class="p">[</span><span class="err">áÜ±ã</span><span class="o">=</span><span class="p">.</span><span class="err">À</span><span class="o">&lt;</span><span class="mi">82</span><span class="o">&gt;</span><span class="err">Ùè</span><span class="n">Ez</span><span class="o">^</span><span class="n">E</span><span class="p">(</span><span class="n">_</span><span class="o">^</span><span class="err">@</span><span class="n">sp</span><span class="err">ø</span><span class="n">Z9</span><span class="err">×</span><span class="o">&lt;</span><span class="mi">93</span><span class="o">&gt;</span><span class="err">\©É</span><span class="o">^</span><span class="p">]</span><span class="err">Ë</span><span class="n">Io</span><span class="o">^</span><span class="n">Z</span><span class="o">?</span><span class="p">(</span><span class="o">^^</span><span class="mi">1</span><span class="o">*</span><span class="err">á¶</span><span class="o">%</span><span class="err">¯²©</span><span class="o">^</span><span class="n">W</span><span class="err">ñ¶</span><span class="n">f7iQK</span><span class="err">ä</span><span class="n">C</span><span class="err">`</span>
</pre></table></code></div></div><p>校验签名文件</p><div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="c1">// 用相同的摘要算法和签名算法校验签名文件，需要对比签名文件和原始文件</span>
<span class="err">$</span> <span class="n">openssl</span> <span class="n">dgst</span> <span class="o">-</span><span class="n">sha256</span> <span class="o">-</span><span class="n">verify</span> <span class="n">rsapublickey</span><span class="p">.</span><span class="n">pem</span> <span class="o">-</span><span class="n">signature</span> <span class="n">signature</span><span class="p">.</span><span class="n">txt</span> <span class="n">plain</span><span class="p">.</span><span class="n">txt</span>
</pre></table></code></div></div><p>输出</p><div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">Verified</span> <span class="n">OK</span>
</pre></table></code></div></div><p>如果怀疑上面校验是否是真的，我们可以用另外一个文件来验证一下签名，比如换一个 txt</p><div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="c1">// 更换一个 txt 文件再次验证签名</span>
<span class="err">$</span> <span class="n">openssl</span> <span class="n">dgst</span> <span class="o">-</span><span class="n">sha256</span> <span class="o">-</span><span class="n">verify</span> <span class="n">rsapublickey</span><span class="p">.</span><span class="n">pem</span> <span class="o">-</span><span class="n">signature</span> <span class="n">signature</span><span class="p">.</span><span class="n">txt</span> <span class="n">signature</span><span class="p">.</span><span class="n">txt</span>
</pre></table></code></div></div><p>输出</p><div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">Verification</span> <span class="n">Failure</span>
</pre></table></code></div></div><p>除去用 sha256 Hash 算法以外，还可以指定 RSASSA-PSS 标准</p><div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="c1">// 生成 RSA 密钥对</span>
<span class="err">$</span> <span class="n">openssl</span> <span class="n">genrsa</span> <span class="o">-</span><span class="n">out</span> <span class="n">rsaprivatekey</span><span class="p">.</span><span class="n">pem</span> <span class="mi">2048</span>
</pre></table></code></div></div><p>输出</p><div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
</pre><td class="rouge-code"><pre><span class="n">Generating</span> <span class="n">RSA</span> <span class="n">private</span> <span class="n">key</span><span class="p">,</span> <span class="mi">2048</span> <span class="n">bit</span> <span class="kt">long</span> <span class="n">modulus</span> <span class="p">(</span><span class="mi">2</span> <span class="n">primes</span><span class="p">)</span>
<span class="p">..........................</span><span class="o">+++</span>
<span class="p">............................</span><span class="o">+++</span>
<span class="n">e</span> <span class="n">is</span> <span class="mi">65537</span> <span class="p">(</span><span class="mh">0x010001</span><span class="p">)</span>

<span class="o">-----</span><span class="n">BEGIN</span> <span class="n">RSA</span> <span class="n">PRIVATE</span> <span class="n">KEY</span><span class="o">-----</span>
<span class="n">MIIEpAIBAAKCAQEAuvYWXiZ7esG</span><span class="o">+</span><span class="n">Vv</span><span class="o">/</span><span class="n">aiOSwoXV1bURTUimwUumQm1N0lOsy0BC4</span>
<span class="n">yxxjhPxz5UNHCUIGFp39Ux6BRRKxAeD</span><span class="o">+</span><span class="n">J13AAte6Ge</span><span class="o">+</span><span class="n">hU3hS</span><span class="o">+</span><span class="n">b1TN55oVpdTX6Er</span>
<span class="mi">1</span><span class="n">GzpnL6bn</span><span class="o">/</span><span class="n">ZCGR7Rd4ml9H58</span><span class="o">+</span><span class="n">n6SKowDRecBYQkuOgMkInLl36dHCuvG65h3KYdT</span>
<span class="n">Emhkb8IjUQAMGjGcbJpkAnjmP5k6RxY</span><span class="c1">//sx9/o/kyPKiYSIJDRVJBShg+ADfkuyT</span>
<span class="n">qD1jAYl7LSsN4w27KQIV0r606WZbTYcWzM4wPU30XFvTLDzp7frueSF8hprJiOA</span><span class="o">/</span>
<span class="n">D6TDaCPbEx9QXeUCvsGCXhTUl7sKkNSSA9jW</span><span class="o">/</span><span class="n">wIDAQABAoIBAGVoMyuwHcuwqKgR</span>
<span class="n">sJwNxsxcpGu24qavHAdszlWhh5t6kx4N492vMT</span><span class="o">+</span><span class="n">hms8glbgsypab7RqXcjBf</span><span class="o">+</span><span class="n">gh1</span>
<span class="mi">3</span><span class="n">ATIMeyYzEVjF5Lpsb</span><span class="o">/</span><span class="n">p8</span><span class="o">+</span><span class="n">g4EInfHIbDKb3XsUKmlEzISoPLlnwK</span><span class="o">+</span><span class="n">ivKK8nGu0s</span><span class="o">+</span>
<span class="n">lEvnB3V1gFBRAdl5jrunxL3kswl3xAOTPUG7HN8SzhKbW2q15iXeIYdsrGDdNmCW</span>
<span class="n">r4ijcW2xuaCAwRIDG9wMsaU</span><span class="o">+</span><span class="n">J0kVBoxqrFcN1t73HdhauDCdHqH7oBYYxCliMvmQ</span>
<span class="n">MainlIcF3hfhS8fPbUm52mepIKjUAw</span><span class="o">+</span><span class="n">mpzlNnhPz6tuk5T1dUu</span><span class="o">/</span><span class="n">hafdIoBZ9yfK1</span>
<span class="n">n6yw14ECgYEA7igQq</span><span class="o">/</span><span class="n">di</span><span class="o">+</span><span class="n">YE7XdV3jgqKCOlWFx68M14NRdNcYZhjPHw2F4waqur</span><span class="o">+</span>
<span class="n">K0FDMLVP</span><span class="o">/</span><span class="n">lPfoI3BWIvjp3qSiMbplKVPokMAdJ0kkwiw</span><span class="o">/</span><span class="n">zSHaz8NYANTET5RQvs1</span>
<span class="n">akhD</span><span class="o">/</span><span class="n">oHiktY</span><span class="o">/</span><span class="n">NKEWlpofKj09dzeALWzhvIz7q7b6sjXXTJVQL6DouMECgYEAyPgT</span>
<span class="mi">6</span><span class="n">w</span><span class="o">+</span><span class="n">yh1Orf8utnCgd2e7YInl</span><span class="o">+</span><span class="mi">5</span><span class="n">RhIZqE4DKeJXjFUhxktimv2d7QJXP7KjAcdjel4</span>
<span class="n">KzQ</span><span class="o">+</span><span class="n">nIDody59GZtibLRMU1p7tAHOFKpV7k7D3ZiDqzn9BsRs</span><span class="o">+</span><span class="n">GemKAjoY5BroL9b</span>
<span class="o">+</span><span class="n">Cdc05ksRRSyd37A1C6sbLepbKyzvUmbzTUfv78CgYAqvRPo2HdxkSiHOVTAL9H</span><span class="o">/</span>
<span class="n">sWgatBBQI5O8MScF</span><span class="o">+</span><span class="n">KPuadgHN8RdYdiFCKw3JIKbgI</span><span class="o">/</span><span class="n">EL0xASLJtDskXNKMcYuI8</span>
<span class="n">m0uModq7bDbfRZz7uQ</span><span class="o">/</span><span class="mi">8</span><span class="n">Z</span><span class="o">/</span><span class="n">xTPty0aYJ3dUqGdOalNT</span><span class="o">+</span><span class="n">YgUQdeMEZAm5yY4pkHIMS</span>
<span class="n">JDbR5P9uVc0yWCVQts6swQKBgQC1QfKNDtJhddh3YdfKwO</span><span class="o">/</span><span class="n">zkJVFurj1nconLn9k</span>
<span class="n">AnNGDk4Dr3TApRFd83aCdpduZjiEty8YIH3cH</span><span class="o">/</span><span class="n">QLElXok5nZG2C</span><span class="o">/</span><span class="n">yRtLRll9kAgC</span>
<span class="mi">8</span><span class="n">O19XsJa2</span><span class="o">+</span><span class="n">lXgjAadzmIYEhhDG</span><span class="o">/</span><span class="n">WQuGLVs1FV6BzCfDRD</span><span class="o">/</span><span class="n">SRKyt</span><span class="o">+</span><span class="n">vsPDbZyLO</span><span class="o">+</span><span class="n">mW</span>
<span class="mi">0</span><span class="n">rQ49wKBgQDhWlAtmZKN12tfvHWpnbhj4rfBaSFpYRh4AimgQJyPvjzy</span><span class="o">/</span><span class="mi">9</span><span class="n">Edw7i5</span>
<span class="n">YAJosFtocanOpnKbYaZCng5wFra9e9</span><span class="o">+</span><span class="n">vwd66Ab80o</span><span class="o">/</span><span class="n">ZzAtuNtyxh1</span><span class="o">+</span><span class="n">LP2c</span><span class="o">+</span><span class="n">XCl8W</span>
<span class="n">dgF4cl4wkopwQ6f8dauG7dKGsP4NunUoXjJO</span><span class="o">/</span><span class="n">Ky</span><span class="o">+</span><span class="n">PcFgzrAeJ3Z8xA</span><span class="o">==</span>
<span class="o">-----</span><span class="n">END</span> <span class="n">RSA</span> <span class="n">PRIVATE</span> <span class="n">KEY</span><span class="o">-----</span>
</pre></table></code></div></div><p>分离出公钥</p><div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="err">$</span> <span class="n">openssl</span> <span class="n">rsa</span> <span class="o">-</span><span class="n">in</span> <span class="n">rsaprivatekey</span><span class="p">.</span><span class="n">pem</span> <span class="o">-</span><span class="n">pubout</span> <span class="o">-</span><span class="n">out</span> <span class="n">rsapublickey</span><span class="p">.</span><span class="n">pem</span>
</pre></table></code></div></div><p>输出</p><div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="o">-----</span><span class="n">BEGIN</span> <span class="n">PUBLIC</span> <span class="n">KEY</span><span class="o">-----</span>
<span class="n">MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAuvYWXiZ7esG</span><span class="o">+</span><span class="n">Vv</span><span class="o">/</span><span class="n">aiOSw</span>
<span class="n">oXV1bURTUimwUumQm1N0lOsy0BC4yxxjhPxz5UNHCUIGFp39Ux6BRRKxAeD</span><span class="o">+</span><span class="n">J13A</span>
<span class="n">Ate6Ge</span><span class="o">+</span><span class="n">hU3hS</span><span class="o">+</span><span class="n">b1TN55oVpdTX6Er1GzpnL6bn</span><span class="o">/</span><span class="n">ZCGR7Rd4ml9H58</span><span class="o">+</span><span class="n">n6SKowDRecB</span>
<span class="n">YQkuOgMkInLl36dHCuvG65h3KYdTEmhkb8IjUQAMGjGcbJpkAnjmP5k6RxY</span><span class="c1">//sx9</span>
<span class="o">/</span><span class="n">o</span><span class="o">/</span><span class="n">kyPKiYSIJDRVJBShg</span><span class="o">+</span><span class="n">ADfkuyTqD1jAYl7LSsN4w27KQIV0r606WZbTYcWzM4w</span>
<span class="n">PU30XFvTLDzp7frueSF8hprJiOA</span><span class="o">/</span><span class="n">D6TDaCPbEx9QXeUCvsGCXhTUl7sKkNSSA9jW</span>
<span class="o">/</span><span class="n">wIDAQAB</span>
<span class="o">-----</span><span class="n">END</span> <span class="n">PUBLIC</span> <span class="n">KEY</span><span class="o">-----</span>
</pre></table></code></div></div><p>指定 RSASSA-PSS 标准</p><div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="c1">// 指定 RSASSA-PSS 标准</span>
<span class="err">$</span> <span class="n">openssl</span> <span class="n">dgst</span> <span class="o">-</span><span class="n">sha256</span> <span class="o">-</span><span class="n">sign</span> <span class="n">rsaprivatekey</span><span class="p">.</span><span class="n">pem</span> <span class="o">-</span><span class="n">sigopt</span> <span class="n">rsa_padding_mode</span><span class="o">:</span><span class="n">pss</span> <span class="o">-</span><span class="n">out</span> <span class="n">signature</span><span class="p">.</span><span class="n">txt</span> <span class="n">plain</span><span class="p">.</span><span class="n">txt</span>
</pre></table></code></div></div><p>打开 signature.txt 文件，里面存储的就是签名之后的结果。</p><div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="err">¡°</span><span class="o">&lt;</span><span class="mi">8</span><span class="n">f</span><span class="o">&gt;^</span><span class="n">W</span><span class="o">-</span><span class="err">ý</span><span class="mi">0</span><span class="p">]</span><span class="err">ê</span><span class="o">^</span><span class="n">Qn</span><span class="err">à</span><span class="o">&lt;</span><span class="mi">90</span><span class="o">&gt;&lt;</span><span class="mi">97</span><span class="o">&gt;</span><span class="n">N</span><span class="o">&lt;</span><span class="mi">9</span><span class="n">e</span><span class="o">&gt;</span><span class="mi">8</span><span class="o">^</span><span class="n">T</span><span class="err">²»</span><span class="o">&lt;</span><span class="mi">97</span><span class="o">&gt;</span><span class="err">¢</span><span class="o">&lt;</span><span class="mi">8</span><span class="n">d</span><span class="o">&gt;</span><span class="err">¤¯</span><span class="o">*</span><span class="n">S</span><span class="o">&lt;</span><span class="mi">98</span><span class="o">&gt;</span><span class="err">ò</span><span class="p">.</span><span class="n">C</span><span class="err">·</span><span class="o">=^</span><span class="n">B</span><span class="err">ñ</span><span class="n">M</span><span class="err">¸</span><span class="n">b</span><span class="err">õ</span><span class="o">^</span><span class="p">[</span><span class="o">&lt;</span><span class="mi">99</span><span class="o">&gt;</span><span class="err">Øã­</span><span class="n">p</span><span class="err">×</span><span class="n">V</span><span class="err">²Ð</span><span class="mi">8</span><span class="n">vz</span><span class="err">#</span><span class="o">^</span><span class="n">Z</span><span class="err">}¹Ô</span><span class="n">O</span><span class="err">¨õò¬</span><span class="o">&lt;</span><span class="mi">85</span><span class="o">&gt;^</span><span class="n">D</span><span class="o">&lt;</span><span class="mi">8</span><span class="n">c</span><span class="o">&gt;</span><span class="err">¦</span><span class="n">C</span><span class="o">^</span><span class="n">W</span><span class="o">^</span><span class="n">K</span><span class="err">²$</span><span class="o">^</span><span class="n">P</span><span class="o">&amp;</span><span class="n">BC</span><span class="err">ô$</span><span class="n">Z4</span><span class="o">&lt;</span><span class="mi">8</span><span class="n">b</span><span class="o">&gt;</span><span class="err">¢</span><span class="n">w</span><span class="o">&lt;</span><span class="mi">9</span><span class="n">c</span><span class="o">&gt;&lt;</span><span class="mi">91</span><span class="o">&gt;</span><span class="err">þ</span><span class="n">z</span><span class="err">@×</span><span class="o">&lt;</span><span class="mi">82</span><span class="o">&gt;</span><span class="err">ùáÇ¶µ</span><span class="o">&amp;</span><span class="mi">8</span><span class="o">&lt;</span><span class="mi">97</span><span class="o">&gt;</span><span class="err">Í</span><span class="o">&lt;</span><span class="mi">8</span><span class="n">a</span><span class="o">&gt;&lt;</span><span class="mi">95</span><span class="o">&gt;</span><span class="mi">4</span><span class="err">ºû</span><span class="mi">7</span><span class="err">É¿#</span><span class="o">^</span><span class="n">X</span><span class="o">&lt;</span><span class="mi">95</span><span class="o">&gt;</span><span class="n">S</span><span class="err">Ü</span><span class="n">_s</span><span class="o">&lt;</span><span class="mi">98</span><span class="o">&gt;</span><span class="n">g</span><span class="o">&lt;</span><span class="mi">9</span><span class="n">a</span><span class="o">&gt;</span><span class="n">l</span><span class="err">ï</span><span class="o">&lt;</span><span class="mi">91</span><span class="o">&gt;&lt;</span><span class="mi">92</span><span class="o">&gt;</span><span class="n">g</span><span class="err">ý</span><span class="o">^</span><span class="n">Bm</span><span class="o">^</span><span class="n">Yw</span><span class="err">'</span><span class="mi">1L</span><span class="n">J7</span><span class="err">¹</span><span class="n">m3</span><span class="o">+&lt;</span><span class="mi">81</span><span class="o">&gt;</span><span class="n">m</span><span class="err">©¥ë\</span><span class="o">&lt;</span><span class="mi">96</span><span class="o">&gt;</span><span class="err">¼</span><span class="n">B</span><span class="err">ÄØ</span><span class="o">&lt;</span><span class="mi">8</span><span class="n">d</span><span class="o">&gt;</span><span class="n">vO</span><span class="err">»Ü</span><span class="o">&lt;</span><span class="mi">82</span><span class="o">&gt;&lt;</span><span class="mi">98</span><span class="o">&gt;</span><span class="err">¨</span><span class="o">^</span><span class="n">K</span><span class="p">]</span><span class="mi">7</span><span class="err">ØÖö</span><span class="n">P</span><span class="err">¿</span><span class="o">^</span><span class="n">F</span><span class="o">^</span><span class="n">_</span><span class="p">[</span><span class="err">Ñã÷Þ</span><span class="mi">3</span><span class="o">^^</span><span class="err">}</span><span class="o">-</span><span class="err">´ý</span><span class="o">&lt;</span><span class="mi">84</span><span class="o">&gt;&lt;</span><span class="mi">9</span><span class="n">f</span><span class="o">&gt;^</span><span class="n">E</span><span class="o">^</span><span class="p">[</span><span class="err">Ö</span><span class="n">A</span><span class="o">&gt;^</span><span class="n">NF</span><span class="o">&lt;</span><span class="mi">8</span><span class="n">f</span><span class="o">&gt;</span><span class="err">É</span><span class="o">!&lt;</span><span class="mi">8</span><span class="n">c</span><span class="o">&gt;</span><span class="err">¿ÿÆ</span><span class="p">,</span><span class="err">º«õ</span><span class="n">t</span><span class="err">ãä</span><span class="n">V8</span><span class="err">ÿ</span><span class="o">&lt;</span><span class="mi">91</span><span class="o">&gt;&lt;</span><span class="mi">8</span><span class="n">b</span><span class="o">&gt;</span><span class="err">Ã</span><span class="n">_</span><span class="err">Å</span><span class="o">&lt;</span><span class="mi">9</span><span class="n">f</span><span class="o">&gt;</span><span class="err">ï</span><span class="o">&lt;</span><span class="mi">88</span><span class="o">&gt;</span><span class="n">Q</span><span class="o">^</span><span class="err">õ</span><span class="o">&lt;</span><span class="mi">99</span><span class="o">&gt;^</span><span class="n">U</span><span class="err">ê</span><span class="o">&lt;</span><span class="mi">9</span><span class="n">c</span><span class="o">&gt;&lt;</span><span class="mi">91</span><span class="o">&gt;^</span><span class="n">E</span><span class="p">)</span><span class="err">Õ$</span><span class="n">H</span><span class="err">¶</span><span class="s">"ç:hDôU*_FÙ&lt;8a&gt;^LÝU&lt;8f&gt;^H©9%uè^_^C¨V&lt;8d&gt;+yB¨^ZR</span><span class="err">
</span></pre></table></code></div></div><p>验证签名</p><div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="c1">// 验证签名</span>
<span class="err">$</span> <span class="n">openssl</span> <span class="n">dgst</span> <span class="o">-</span><span class="n">sha256</span> <span class="o">-</span><span class="n">verify</span> <span class="n">rsapublickey</span><span class="p">.</span><span class="n">pem</span> <span class="o">-</span><span class="n">sigopt</span> <span class="n">rsa_padding_mode</span><span class="o">:</span><span class="n">pss</span> <span class="o">-</span><span class="n">signature</span> <span class="n">signature</span><span class="p">.</span><span class="n">txt</span> <span class="n">plain</span><span class="p">.</span><span class="n">txt</span>
</pre></table></code></div></div><p>输出</p><div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">Verified</span> <span class="n">OK</span>
</pre></table></code></div></div><p>如果怀疑上面校验是否是真的，我们可以用另外一个文件来验证一下签名，比如换一个 txt，或者不用 PSS 模式去校验，以上两种方法都会校验失败。</p><div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="c1">// 更换一个 txt 文件再次验证签名</span>
<span class="err">$</span> <span class="n">openssl</span> <span class="n">dgst</span> <span class="o">-</span><span class="n">sha256</span> <span class="o">-</span><span class="n">verify</span> <span class="n">rsapublickey</span><span class="p">.</span><span class="n">pem</span> <span class="o">-</span><span class="n">sigopt</span> <span class="n">rsa_padding_mode</span><span class="o">:</span><span class="n">pss</span> <span class="o">-</span><span class="n">signature</span> <span class="n">signature</span><span class="p">.</span><span class="n">txt</span> <span class="n">signature</span><span class="p">.</span><span class="n">txt</span>

<span class="c1">// 不用 PSS 模式验证签名</span>
<span class="err">$</span> <span class="n">openssl</span> <span class="n">dgst</span> <span class="o">-</span><span class="n">sha256</span> <span class="o">-</span><span class="n">verify</span> <span class="n">rsapublickey</span><span class="p">.</span><span class="n">pem</span> <span class="o">-</span><span class="n">signature</span> <span class="n">signature</span><span class="p">.</span><span class="n">txt</span> <span class="n">plain</span><span class="p">.</span><span class="n">txt</span>
</pre></table></code></div></div><p>上面两种方式都会校验失败。</p><h2 id="十openssl-中的-dsa-数字签名">十、OpenSSL 中的 DSA 数字签名</h2><p>使用 OpenSSL 命令了解 DSA 算法。</p><div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="c1">// 生成参数文件，类似于 DH 参数文件</span>
<span class="err">$</span> <span class="n">openssl</span> <span class="n">dsaparam</span> <span class="o">-</span><span class="n">out</span> <span class="n">dsaparam</span><span class="p">.</span><span class="n">pem</span> <span class="mi">1024</span>
</pre></table></code></div></div><p>输出</p><div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="n">Generating</span> <span class="n">DSA</span> <span class="n">parameters</span><span class="p">,</span> <span class="mi">1024</span> <span class="n">bit</span> <span class="kt">long</span> <span class="n">prime</span>
<span class="n">This</span> <span class="n">could</span> <span class="n">take</span> <span class="n">some</span> <span class="n">time</span>
<span class="p">..........</span><span class="o">+</span><span class="p">..</span><span class="o">+</span><span class="p">.............................</span><span class="o">+++++++++++++++++++++++++++++++++++++++++++++++++++*</span>
<span class="p">..</span><span class="o">+</span><span class="p">..</span><span class="o">+</span><span class="p">....</span><span class="o">+</span><span class="p">....</span><span class="o">+</span><span class="p">.</span><span class="o">+</span><span class="p">....</span><span class="o">+</span><span class="p">..............</span><span class="o">+</span><span class="p">.....</span><span class="o">+</span><span class="p">...</span><span class="o">+</span><span class="p">.</span><span class="o">+</span><span class="p">...................</span><span class="o">+</span><span class="p">.</span><span class="o">+</span><span class="p">...........</span><span class="o">+</span><span class="p">.</span><span class="o">+</span><span class="p">..</span><span class="o">+</span><span class="p">...</span><span class="o">+++++++++++++++++++++++++++++++++++++++++++++++++++*</span>

<span class="o">-----</span><span class="n">BEGIN</span> <span class="n">DSA</span> <span class="n">PARAMETERS</span><span class="o">-----</span>
<span class="n">MIIBHgKBgQDbXt</span><span class="o">+</span><span class="n">UNxsM2KJGR5q76uqWDgmZKSV3vordjqdwirG</span><span class="o">/</span><span class="n">ukuRkBrg0p7y</span>
<span class="n">Whhd8s</span><span class="o">+</span><span class="n">As</span><span class="o">+</span><span class="n">Q0erzE9mQfyKrqnQjAAxBOT</span><span class="o">/</span><span class="mi">9</span><span class="n">rjH4hvYcgg0H</span><span class="o">/</span><span class="n">uSzWrkRIgZx7</span><span class="o">/</span><span class="mi">8</span><span class="n">dF</span>
<span class="n">dnOEH</span><span class="o">+</span><span class="n">ORwgQlbxZ</span><span class="o">+</span><span class="n">p1k</span><span class="o">/</span><span class="n">Le4rJh</span><span class="o">/</span><span class="n">dTARRbAjCa</span><span class="o">+</span><span class="n">YkAU9ZL8cGnsQvWQIVAJ8v</span><span class="o">+</span><span class="n">YVH</span>
<span class="n">YjCApNnLjEBVRTF4kvSpAoGAearp5Wi8BtC77al</span><span class="o">/</span><span class="n">P</span><span class="o">+</span><span class="n">W</span><span class="o">/</span><span class="n">KfxTrp3TmMFwImWG</span><span class="o">+</span><span class="n">Fqd</span>
<span class="n">GVa4poqhYEcFGSaZsrnFZGOwT0PgFLvFCzkz0sfn0OeT7haSIwr8lVcnXL3dexWY</span>
<span class="n">ejEeWDa1nCERqAL9r</span><span class="o">/</span><span class="n">eO5QldwSgw6muCjNA</span><span class="o">/</span><span class="n">A7eghz1E5KQxjYkRQGLdYx</span><span class="o">+</span><span class="n">fbC1N</span>
<span class="n">ge4</span><span class="o">=</span>
<span class="o">-----</span><span class="n">END</span> <span class="n">DSA</span> <span class="n">PARAMETERS</span><span class="o">-----</span>
</pre></table></code></div></div><p>生成密钥对</p><div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="c1">// 通过参数文件生成密钥对 dsaprivatekey.pem</span>
<span class="err">$</span> <span class="n">openssl</span> <span class="n">gendsa</span> <span class="o">-</span><span class="n">out</span> <span class="n">dsaprivatekey</span><span class="p">.</span><span class="n">pem</span> <span class="n">dsaparam</span><span class="p">.</span><span class="n">pem</span>
</pre></table></code></div></div><p>输出</p><div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="n">Generating</span> <span class="n">DSA</span> <span class="n">key</span><span class="p">,</span> <span class="mi">1024</span> <span class="n">bits</span>

<span class="o">-----</span><span class="n">BEGIN</span> <span class="n">DSA</span> <span class="n">PRIVATE</span> <span class="n">KEY</span><span class="o">-----</span>
<span class="n">MIIBuwIBAAKBgQDbXt</span><span class="o">+</span><span class="n">UNxsM2KJGR5q76uqWDgmZKSV3vordjqdwirG</span><span class="o">/</span><span class="n">ukuRkBrg</span>
<span class="mi">0</span><span class="n">p7yWhhd8s</span><span class="o">+</span><span class="n">As</span><span class="o">+</span><span class="n">Q0erzE9mQfyKrqnQjAAxBOT</span><span class="o">/</span><span class="mi">9</span><span class="n">rjH4hvYcgg0H</span><span class="o">/</span><span class="n">uSzWrkRIgZx7</span>
<span class="o">/</span><span class="mi">8</span><span class="n">dFdnOEH</span><span class="o">+</span><span class="n">ORwgQlbxZ</span><span class="o">+</span><span class="n">p1k</span><span class="o">/</span><span class="n">Le4rJh</span><span class="o">/</span><span class="n">dTARRbAjCa</span><span class="o">+</span><span class="n">YkAU9ZL8cGnsQvWQIVAJ8v</span>
<span class="o">+</span><span class="n">YVHYjCApNnLjEBVRTF4kvSpAoGAearp5Wi8BtC77al</span><span class="o">/</span><span class="n">P</span><span class="o">+</span><span class="n">W</span><span class="o">/</span><span class="n">KfxTrp3TmMFwImWG</span>
<span class="o">+</span><span class="n">FqdGVa4poqhYEcFGSaZsrnFZGOwT0PgFLvFCzkz0sfn0OeT7haSIwr8lVcnXL3d</span>
<span class="n">exWYejEeWDa1nCERqAL9r</span><span class="o">/</span><span class="n">eO5QldwSgw6muCjNA</span><span class="o">/</span><span class="n">A7eghz1E5KQxjYkRQGLdYx</span><span class="o">+</span><span class="n">f</span>
<span class="n">bC1Nge4CgYB6o8lSB4HkznXMyVkByLeRo5IE</span><span class="o">+</span><span class="n">IQqKcFtM4kD6d4ZukcI2IUHp7bI</span>
<span class="n">jYSjJNyalYTwPcCMgpWJEseC6Xcf90gR39Sz</span><span class="o">/</span><span class="n">P2</span><span class="o">+</span><span class="n">pWiyCzhJ1CXHlQzwpOIAKuOq</span>
<span class="n">ojwlykrYBZuPuD0Bpo2kUJKyua</span><span class="o">/</span><span class="n">Te1b8cfElVMyr7OrCN0HIBIHovQIVAJbryCYW</span>
<span class="mi">7</span><span class="n">s9I2PGsiuz758FMjZ9Z</span>
<span class="o">-----</span><span class="n">END</span> <span class="n">DSA</span> <span class="n">PRIVATE</span> <span class="n">KEY</span><span class="o">-----</span>
</pre></table></code></div></div><p>对私钥文件进行加密</p><div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="c1">// 对私钥对文件使用 des3 算法进行加密</span>
<span class="err">$</span> <span class="n">openssl</span> <span class="n">gendsa</span> <span class="o">-</span><span class="n">out</span> <span class="n">dsaprivatekey2</span><span class="p">.</span><span class="n">pem</span> <span class="o">-</span><span class="n">des3</span> <span class="n">dsaparam</span><span class="p">.</span><span class="n">pem</span>
</pre></table></code></div></div><p>输出</p><div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre><span class="n">Generating</span> <span class="n">DSA</span> <span class="n">key</span><span class="p">,</span> <span class="mi">1024</span> <span class="n">bits</span>
<span class="n">Enter</span> <span class="n">PEM</span> <span class="n">pass</span> <span class="n">phrase</span><span class="o">:</span>
<span class="n">Verifying</span> <span class="o">-</span> <span class="n">Enter</span> <span class="n">PEM</span> <span class="n">pass</span> <span class="n">phrase</span><span class="o">:</span>

<span class="o">----</span><span class="n">BEGIN</span> <span class="n">DSA</span> <span class="n">PRIVATE</span> <span class="n">KEY</span><span class="o">-----</span>
<span class="n">Proc</span><span class="o">-</span><span class="n">Type</span><span class="o">:</span> <span class="mi">4</span><span class="p">,</span><span class="n">ENCRYPTED</span>
<span class="n">DEK</span><span class="o">-</span><span class="n">Info</span><span class="o">:</span> <span class="n">DES</span><span class="o">-</span><span class="n">EDE3</span><span class="o">-</span><span class="n">CBC</span><span class="p">,</span><span class="n">E06226CA00C80472</span>

<span class="n">xTbh4VYy44X</span><span class="o">/</span><span class="mi">0</span><span class="n">sZMmUfuPua9VtunXtcdJ3soFHvjpjBaCgn64</span><span class="o">/</span><span class="n">nVbGQYBV1t6TY0</span>
<span class="n">Poic5LmZ</span><span class="o">+</span><span class="n">ooVCAxC9EkUid</span><span class="o">+</span><span class="n">TzZ3qCWwI3Pdagj8YoNWrak6ayj6j00EZ2HQNs3eI</span>
<span class="n">j2lyIpyetpJCziGvohveEnmFEU6k7DSKdgpJtZv2yayK4L19r8AIcGlgO</span><span class="o">/</span><span class="n">o125qH</span>
<span class="n">VP4vJvoEAuFMrxXJP3NgJ0ZcF9fffAZz6sV</span><span class="o">+</span><span class="n">lHGVb6B8rWptWwP9QRNGNfdqa5T9</span>
<span class="n">RJAbZrYpvyBlewljDXscB34eYo6PrlItlTWImvJ</span><span class="o">+</span><span class="n">KrVA8QLpYditIcjjdlNDYvRq</span>
<span class="n">eC7sgyDGaKNBSk</span><span class="o">+</span><span class="n">DDQ5ZKQaI9MEPi34kAqp</span><span class="o">+</span><span class="n">esv083WbnXhCkkSzcu5sacxPJJQN</span>
<span class="n">XK0nxP3YSWY7w0L</span><span class="o">/</span><span class="n">cDzxnsaT0gl</span><span class="o">+</span><span class="n">l3AFvUxDge97iq3hmDGt6BSqLzAQAcn4VDnx</span>
<span class="n">Hc0OQKm3hZalej6iLNenf84SWxC7dc0cRgfReMOXhjik</span><span class="o">+</span><span class="n">PsN4eturhDkGzapiHW2</span>
<span class="n">YLVG15f</span><span class="o">+/</span><span class="n">XEknnvW5RQ8ttTPB47O7UFxxt4JLw4KE3nsDkGYFweEOwffVWFo3MH8</span>
<span class="o">+</span><span class="n">uYhp</span><span class="o">/</span><span class="n">Inu8Z0bTVUCm5bSA</span><span class="o">==</span>
<span class="o">-----</span><span class="n">END</span> <span class="n">DSA</span> <span class="n">PRIVATE</span> <span class="n">KEY</span><span class="o">-----</span>
</pre></table></code></div></div><p>提取公钥</p><div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="c1">// 通过密钥对文件拆分出公钥</span>
<span class="err">$</span> <span class="n">openssl</span> <span class="n">dsa</span> <span class="o">-</span><span class="n">in</span> <span class="n">dsaprivatekey</span><span class="p">.</span><span class="n">pem</span> <span class="o">-</span><span class="n">pubout</span> <span class="o">-</span><span class="n">out</span> <span class="n">dsapublickey</span><span class="p">.</span><span class="n">pem</span>
</pre></table></code></div></div><p>输出</p><div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="n">read</span> <span class="n">DSA</span> <span class="n">key</span>
<span class="n">writing</span> <span class="n">DSA</span> <span class="n">key</span>

<span class="o">-----</span><span class="n">BEGIN</span> <span class="n">PUBLIC</span> <span class="n">KEY</span><span class="o">-----</span>
<span class="n">MIIBtjCCASsGByqGSM44BAEwggEeAoGBANte35Q3GwzYokZHmrvq6pYOCZkpJXe</span><span class="o">+</span>
<span class="n">it2Op3CKsb</span><span class="o">+</span><span class="mi">6</span><span class="n">S5GQGuDSnvJaGF3yz4Cz5DR6vMT2ZB</span><span class="o">/</span><span class="n">IquqdCMADEE5P</span><span class="o">/</span><span class="mi">2u</span><span class="n">MfiG9</span>
<span class="n">hyCDQf</span><span class="o">+</span><span class="mi">5L</span><span class="n">NauREiBnHv</span><span class="o">/</span><span class="n">x0V2c4Qf45HCBCVvFn6nWT8t7ismH91MBFFsCMJr5iQB</span>
<span class="n">T1kvxwaexC9ZAhUAny</span><span class="o">/</span><span class="mi">5</span><span class="n">hUdiMICk2cuMQFVFMXiS9KkCgYB5qunlaLwG0LvtqX8</span><span class="o">/</span>
<span class="mi">5</span><span class="n">b8p</span><span class="o">/</span><span class="n">FOundOYwXAiZYb4Wp0ZVrimiqFgRwUZJpmyucVkY7BPQ</span><span class="o">+</span><span class="n">AUu8ULOTPSx</span><span class="o">+</span><span class="n">fQ</span>
<span class="mi">55</span><span class="n">PuFpIjCvyVVydcvd17FZh6MR5YNrWcIRGoAv2v947lCV3BKDDqa4KM0D8Dt6CH</span>
<span class="n">PUTkpDGNiRFAYt1jH59sLU2B7gOBhAACgYB6o8lSB4HkznXMyVkByLeRo5IE</span><span class="o">+</span><span class="n">IQq</span>
<span class="n">KcFtM4kD6d4ZukcI2IUHp7bIjYSjJNyalYTwPcCMgpWJEseC6Xcf90gR39Sz</span><span class="o">/</span><span class="n">P2</span><span class="o">+</span>
<span class="n">pWiyCzhJ1CXHlQzwpOIAKuOqojwlykrYBZuPuD0Bpo2kUJKyua</span><span class="o">/</span><span class="n">Te1b8cfElVMyr</span>
<span class="mi">7</span><span class="n">OrCN0HIBIHovQ</span><span class="o">==</span>
<span class="o">-----</span><span class="n">END</span> <span class="n">PUBLIC</span> <span class="n">KEY</span><span class="o">-----</span>
</pre></table></code></div></div><p>查看私钥文件的信息</p><div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="c1">// 查看三个公共参数、公钥、私钥</span>
<span class="err">$</span> <span class="n">openssl</span> <span class="n">dsa</span> <span class="o">-</span><span class="n">in</span> <span class="n">dsaprivatekey</span><span class="p">.</span><span class="n">pem</span> <span class="o">-</span><span class="n">text</span>
</pre></table></code></div></div><p>输出</p><div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
</pre><td class="rouge-code"><pre><span class="n">read</span> <span class="n">DSA</span> <span class="n">key</span>
<span class="n">Private</span><span class="o">-</span><span class="n">Key</span><span class="o">:</span> <span class="p">(</span><span class="mi">1024</span> <span class="n">bit</span><span class="p">)</span>
<span class="n">priv</span><span class="o">:</span>
    <span class="mo">00</span><span class="o">:</span><span class="mi">96</span><span class="o">:</span><span class="n">eb</span><span class="o">:</span><span class="n">c8</span><span class="o">:</span><span class="mi">26</span><span class="o">:</span><span class="mi">16</span><span class="o">:</span><span class="n">ee</span><span class="o">:</span><span class="n">cf</span><span class="o">:</span><span class="mi">48</span><span class="o">:</span><span class="n">d8</span><span class="o">:</span><span class="n">f1</span><span class="o">:</span><span class="n">ac</span><span class="o">:</span><span class="mi">8</span><span class="n">a</span><span class="o">:</span><span class="n">ec</span><span class="o">:</span><span class="n">fb</span><span class="o">:</span>
    <span class="n">e7</span><span class="o">:</span><span class="n">c1</span><span class="o">:</span><span class="mi">4</span><span class="n">c</span><span class="o">:</span><span class="mi">8</span><span class="n">d</span><span class="o">:</span><span class="mi">9</span><span class="n">f</span><span class="o">:</span><span class="mi">59</span>
<span class="n">pub</span><span class="o">:</span>
    <span class="mi">7</span><span class="n">a</span><span class="o">:</span><span class="n">a3</span><span class="o">:</span><span class="n">c9</span><span class="o">:</span><span class="mi">52</span><span class="o">:</span><span class="mo">07</span><span class="o">:</span><span class="mi">81</span><span class="o">:</span><span class="n">e4</span><span class="o">:</span><span class="n">ce</span><span class="o">:</span><span class="mi">75</span><span class="o">:</span><span class="n">cc</span><span class="o">:</span><span class="n">c9</span><span class="o">:</span><span class="mi">59</span><span class="o">:</span><span class="mo">01</span><span class="o">:</span><span class="n">c8</span><span class="o">:</span><span class="n">b7</span><span class="o">:</span>
    <span class="mi">91</span><span class="o">:</span><span class="n">a3</span><span class="o">:</span><span class="mi">92</span><span class="o">:</span><span class="mo">04</span><span class="o">:</span><span class="n">f8</span><span class="o">:</span><span class="mi">84</span><span class="o">:</span><span class="mi">2</span><span class="n">a</span><span class="o">:</span><span class="mi">29</span><span class="o">:</span><span class="n">c1</span><span class="o">:</span><span class="mi">6</span><span class="n">d</span><span class="o">:</span><span class="mi">33</span><span class="o">:</span><span class="mi">89</span><span class="o">:</span><span class="mo">03</span><span class="o">:</span><span class="n">e9</span><span class="o">:</span><span class="n">de</span><span class="o">:</span>
    <span class="mi">19</span><span class="o">:</span><span class="n">ba</span><span class="o">:</span><span class="mi">47</span><span class="o">:</span><span class="mi">08</span><span class="o">:</span><span class="n">d8</span><span class="o">:</span><span class="mi">85</span><span class="o">:</span><span class="mo">07</span><span class="o">:</span><span class="n">a7</span><span class="o">:</span><span class="n">b6</span><span class="o">:</span><span class="n">c8</span><span class="o">:</span><span class="mi">8</span><span class="n">d</span><span class="o">:</span><span class="mi">84</span><span class="o">:</span><span class="n">a3</span><span class="o">:</span><span class="mi">24</span><span class="o">:</span><span class="n">dc</span><span class="o">:</span>
    <span class="mi">9</span><span class="n">a</span><span class="o">:</span><span class="mi">95</span><span class="o">:</span><span class="mi">84</span><span class="o">:</span><span class="n">f0</span><span class="o">:</span><span class="mi">3</span><span class="n">d</span><span class="o">:</span><span class="n">c0</span><span class="o">:</span><span class="mi">8</span><span class="n">c</span><span class="o">:</span><span class="mi">82</span><span class="o">:</span><span class="mi">95</span><span class="o">:</span><span class="mi">89</span><span class="o">:</span><span class="mi">12</span><span class="o">:</span><span class="n">c7</span><span class="o">:</span><span class="mi">82</span><span class="o">:</span><span class="n">e9</span><span class="o">:</span><span class="mi">77</span><span class="o">:</span>
    <span class="mi">1</span><span class="n">f</span><span class="o">:</span><span class="n">f7</span><span class="o">:</span><span class="mi">48</span><span class="o">:</span><span class="mi">11</span><span class="o">:</span><span class="n">df</span><span class="o">:</span><span class="n">d4</span><span class="o">:</span><span class="n">b3</span><span class="o">:</span><span class="n">fc</span><span class="o">:</span><span class="n">fd</span><span class="o">:</span><span class="n">be</span><span class="o">:</span><span class="n">a5</span><span class="o">:</span><span class="mi">68</span><span class="o">:</span><span class="n">b2</span><span class="o">:</span><span class="mi">0</span><span class="n">b</span><span class="o">:</span><span class="mi">38</span><span class="o">:</span>
    <span class="mi">49</span><span class="o">:</span><span class="n">d4</span><span class="o">:</span><span class="mi">25</span><span class="o">:</span><span class="n">c7</span><span class="o">:</span><span class="mi">95</span><span class="o">:</span><span class="mi">0</span><span class="n">c</span><span class="o">:</span><span class="n">f0</span><span class="o">:</span><span class="n">a4</span><span class="o">:</span><span class="n">e2</span><span class="o">:</span><span class="mo">00</span><span class="o">:</span><span class="mi">2</span><span class="n">a</span><span class="o">:</span><span class="n">e3</span><span class="o">:</span><span class="n">aa</span><span class="o">:</span><span class="n">a2</span><span class="o">:</span><span class="mi">3</span><span class="n">c</span><span class="o">:</span>
    <span class="mi">25</span><span class="o">:</span><span class="n">ca</span><span class="o">:</span><span class="mi">4</span><span class="n">a</span><span class="o">:</span><span class="n">d8</span><span class="o">:</span><span class="mo">05</span><span class="o">:</span><span class="mi">9</span><span class="n">b</span><span class="o">:</span><span class="mi">8</span><span class="n">f</span><span class="o">:</span><span class="n">b8</span><span class="o">:</span><span class="mi">3</span><span class="n">d</span><span class="o">:</span><span class="mo">01</span><span class="o">:</span><span class="n">a6</span><span class="o">:</span><span class="mi">8</span><span class="n">d</span><span class="o">:</span><span class="n">a4</span><span class="o">:</span><span class="mi">50</span><span class="o">:</span><span class="mi">92</span><span class="o">:</span>
    <span class="n">b2</span><span class="o">:</span><span class="n">b9</span><span class="o">:</span><span class="n">af</span><span class="o">:</span><span class="n">d3</span><span class="o">:</span><span class="mi">7</span><span class="n">b</span><span class="o">:</span><span class="mi">56</span><span class="o">:</span><span class="n">fc</span><span class="o">:</span><span class="mi">71</span><span class="o">:</span><span class="n">f1</span><span class="o">:</span><span class="mi">25</span><span class="o">:</span><span class="mi">54</span><span class="o">:</span><span class="n">cc</span><span class="o">:</span><span class="n">ab</span><span class="o">:</span><span class="n">ec</span><span class="o">:</span><span class="n">ea</span><span class="o">:</span>
    <span class="n">c2</span><span class="o">:</span><span class="mi">37</span><span class="o">:</span><span class="mi">41</span><span class="o">:</span><span class="n">c8</span><span class="o">:</span><span class="mo">04</span><span class="o">:</span><span class="mi">81</span><span class="o">:</span><span class="n">e8</span><span class="o">:</span><span class="n">bd</span>
<span class="n">P</span><span class="o">:</span>
    <span class="mo">00</span><span class="o">:</span><span class="n">db</span><span class="o">:</span><span class="mi">5</span><span class="n">e</span><span class="o">:</span><span class="n">df</span><span class="o">:</span><span class="mi">94</span><span class="o">:</span><span class="mi">37</span><span class="o">:</span><span class="mi">1</span><span class="n">b</span><span class="o">:</span><span class="mi">0</span><span class="n">c</span><span class="o">:</span><span class="n">d8</span><span class="o">:</span><span class="n">a2</span><span class="o">:</span><span class="mi">46</span><span class="o">:</span><span class="mi">47</span><span class="o">:</span><span class="mi">9</span><span class="n">a</span><span class="o">:</span><span class="n">bb</span><span class="o">:</span><span class="n">ea</span><span class="o">:</span>
    <span class="n">ea</span><span class="o">:</span><span class="mi">96</span><span class="o">:</span><span class="mi">0</span><span class="n">e</span><span class="o">:</span><span class="mi">09</span><span class="o">:</span><span class="mi">99</span><span class="o">:</span><span class="mi">29</span><span class="o">:</span><span class="mi">25</span><span class="o">:</span><span class="mi">77</span><span class="o">:</span><span class="n">be</span><span class="o">:</span><span class="mi">8</span><span class="n">a</span><span class="o">:</span><span class="n">dd</span><span class="o">:</span><span class="mi">8</span><span class="n">e</span><span class="o">:</span><span class="n">a7</span><span class="o">:</span><span class="mi">70</span><span class="o">:</span><span class="mi">8</span><span class="n">a</span><span class="o">:</span>
    <span class="n">b1</span><span class="o">:</span><span class="n">bf</span><span class="o">:</span><span class="n">ba</span><span class="o">:</span><span class="mi">4</span><span class="n">b</span><span class="o">:</span><span class="mi">91</span><span class="o">:</span><span class="mi">90</span><span class="o">:</span><span class="mi">1</span><span class="n">a</span><span class="o">:</span><span class="n">e0</span><span class="o">:</span><span class="n">d2</span><span class="o">:</span><span class="mi">9</span><span class="n">e</span><span class="o">:</span><span class="n">f2</span><span class="o">:</span><span class="mi">5</span><span class="n">a</span><span class="o">:</span><span class="mi">18</span><span class="o">:</span><span class="mi">5</span><span class="n">d</span><span class="o">:</span><span class="n">f2</span><span class="o">:</span>
    <span class="n">cf</span><span class="o">:</span><span class="mi">80</span><span class="o">:</span><span class="n">b3</span><span class="o">:</span><span class="n">e4</span><span class="o">:</span><span class="mi">34</span><span class="o">:</span><span class="mi">7</span><span class="n">a</span><span class="o">:</span><span class="n">bc</span><span class="o">:</span><span class="n">c4</span><span class="o">:</span><span class="n">f6</span><span class="o">:</span><span class="mi">64</span><span class="o">:</span><span class="mi">1</span><span class="n">f</span><span class="o">:</span><span class="n">c8</span><span class="o">:</span><span class="n">aa</span><span class="o">:</span><span class="n">ea</span><span class="o">:</span><span class="mi">9</span><span class="n">d</span><span class="o">:</span>
    <span class="mi">08</span><span class="o">:</span><span class="n">c0</span><span class="o">:</span><span class="mo">03</span><span class="o">:</span><span class="mi">10</span><span class="o">:</span><span class="mi">4</span><span class="n">e</span><span class="o">:</span><span class="mi">4</span><span class="n">f</span><span class="o">:</span><span class="n">ff</span><span class="o">:</span><span class="mi">6</span><span class="n">b</span><span class="o">:</span><span class="mi">8</span><span class="n">c</span><span class="o">:</span><span class="mi">7</span><span class="n">e</span><span class="o">:</span><span class="mi">21</span><span class="o">:</span><span class="n">bd</span><span class="o">:</span><span class="mi">87</span><span class="o">:</span><span class="mi">20</span><span class="o">:</span><span class="mi">83</span><span class="o">:</span>
    <span class="mi">41</span><span class="o">:</span><span class="n">ff</span><span class="o">:</span><span class="n">b9</span><span class="o">:</span><span class="mi">2</span><span class="n">c</span><span class="o">:</span><span class="n">d6</span><span class="o">:</span><span class="n">ae</span><span class="o">:</span><span class="mi">44</span><span class="o">:</span><span class="mi">48</span><span class="o">:</span><span class="mi">81</span><span class="o">:</span><span class="mi">9</span><span class="n">c</span><span class="o">:</span><span class="mi">7</span><span class="n">b</span><span class="o">:</span><span class="n">ff</span><span class="o">:</span><span class="n">c7</span><span class="o">:</span><span class="mi">45</span><span class="o">:</span><span class="mi">76</span><span class="o">:</span>
    <span class="mi">73</span><span class="o">:</span><span class="mi">84</span><span class="o">:</span><span class="mi">1</span><span class="n">f</span><span class="o">:</span><span class="n">e3</span><span class="o">:</span><span class="mi">91</span><span class="o">:</span><span class="n">c2</span><span class="o">:</span><span class="mo">04</span><span class="o">:</span><span class="mi">25</span><span class="o">:</span><span class="mi">6</span><span class="n">f</span><span class="o">:</span><span class="mi">16</span><span class="o">:</span><span class="mi">7</span><span class="n">e</span><span class="o">:</span><span class="n">a7</span><span class="o">:</span><span class="mi">59</span><span class="o">:</span><span class="mi">3</span><span class="n">f</span><span class="o">:</span><span class="mi">2</span><span class="n">d</span><span class="o">:</span>
    <span class="n">ee</span><span class="o">:</span><span class="mi">2</span><span class="n">b</span><span class="o">:</span><span class="mi">26</span><span class="o">:</span><span class="mi">1</span><span class="n">f</span><span class="o">:</span><span class="n">dd</span><span class="o">:</span><span class="mi">4</span><span class="n">c</span><span class="o">:</span><span class="mo">04</span><span class="o">:</span><span class="mi">51</span><span class="o">:</span><span class="mi">6</span><span class="n">c</span><span class="o">:</span><span class="mi">08</span><span class="o">:</span><span class="n">c2</span><span class="o">:</span><span class="mi">6</span><span class="n">b</span><span class="o">:</span><span class="n">e6</span><span class="o">:</span><span class="mi">24</span><span class="o">:</span><span class="mo">01</span><span class="o">:</span>
    <span class="mi">4</span><span class="n">f</span><span class="o">:</span><span class="mi">59</span><span class="o">:</span><span class="mi">2</span><span class="n">f</span><span class="o">:</span><span class="n">c7</span><span class="o">:</span><span class="mo">06</span><span class="o">:</span><span class="mi">9</span><span class="n">e</span><span class="o">:</span><span class="n">c4</span><span class="o">:</span><span class="mi">2</span><span class="n">f</span><span class="o">:</span><span class="mi">59</span>
<span class="n">Q</span><span class="o">:</span>
    <span class="mo">00</span><span class="o">:</span><span class="mi">9</span><span class="n">f</span><span class="o">:</span><span class="mi">2</span><span class="n">f</span><span class="o">:</span><span class="n">f9</span><span class="o">:</span><span class="mi">85</span><span class="o">:</span><span class="mi">47</span><span class="o">:</span><span class="mi">62</span><span class="o">:</span><span class="mi">30</span><span class="o">:</span><span class="mi">80</span><span class="o">:</span><span class="n">a4</span><span class="o">:</span><span class="n">d9</span><span class="o">:</span><span class="n">cb</span><span class="o">:</span><span class="mi">8</span><span class="n">c</span><span class="o">:</span><span class="mi">40</span><span class="o">:</span><span class="mi">55</span><span class="o">:</span>
    <span class="mi">45</span><span class="o">:</span><span class="mi">31</span><span class="o">:</span><span class="mi">78</span><span class="o">:</span><span class="mi">92</span><span class="o">:</span><span class="n">f4</span><span class="o">:</span><span class="n">a9</span>
<span class="n">G</span><span class="o">:</span>
    <span class="mi">79</span><span class="o">:</span><span class="n">aa</span><span class="o">:</span><span class="n">e9</span><span class="o">:</span><span class="n">e5</span><span class="o">:</span><span class="mi">68</span><span class="o">:</span><span class="n">bc</span><span class="o">:</span><span class="mo">06</span><span class="o">:</span><span class="n">d0</span><span class="o">:</span><span class="n">bb</span><span class="o">:</span><span class="n">ed</span><span class="o">:</span><span class="n">a9</span><span class="o">:</span><span class="mi">7</span><span class="n">f</span><span class="o">:</span><span class="mi">3</span><span class="n">f</span><span class="o">:</span><span class="n">e5</span><span class="o">:</span><span class="n">bf</span><span class="o">:</span>
    <span class="mi">29</span><span class="o">:</span><span class="n">fc</span><span class="o">:</span><span class="mi">53</span><span class="o">:</span><span class="n">ae</span><span class="o">:</span><span class="mi">9</span><span class="n">d</span><span class="o">:</span><span class="n">d3</span><span class="o">:</span><span class="mi">98</span><span class="o">:</span><span class="n">c1</span><span class="o">:</span><span class="mi">70</span><span class="o">:</span><span class="mi">22</span><span class="o">:</span><span class="mi">65</span><span class="o">:</span><span class="mi">86</span><span class="o">:</span><span class="n">f8</span><span class="o">:</span><span class="mi">5</span><span class="n">a</span><span class="o">:</span><span class="mi">9</span><span class="n">d</span><span class="o">:</span>
    <span class="mi">19</span><span class="o">:</span><span class="mi">56</span><span class="o">:</span><span class="n">b8</span><span class="o">:</span><span class="n">a6</span><span class="o">:</span><span class="mi">8</span><span class="n">a</span><span class="o">:</span><span class="n">a1</span><span class="o">:</span><span class="mi">60</span><span class="o">:</span><span class="mi">47</span><span class="o">:</span><span class="mo">05</span><span class="o">:</span><span class="mi">19</span><span class="o">:</span><span class="mi">26</span><span class="o">:</span><span class="mi">99</span><span class="o">:</span><span class="n">b2</span><span class="o">:</span><span class="n">b9</span><span class="o">:</span><span class="n">c5</span><span class="o">:</span>
    <span class="mi">64</span><span class="o">:</span><span class="mi">63</span><span class="o">:</span><span class="n">b0</span><span class="o">:</span><span class="mi">4</span><span class="n">f</span><span class="o">:</span><span class="mi">43</span><span class="o">:</span><span class="n">e0</span><span class="o">:</span><span class="mi">14</span><span class="o">:</span><span class="n">bb</span><span class="o">:</span><span class="n">c5</span><span class="o">:</span><span class="mi">0</span><span class="n">b</span><span class="o">:</span><span class="mi">39</span><span class="o">:</span><span class="mi">33</span><span class="o">:</span><span class="n">d2</span><span class="o">:</span><span class="n">c7</span><span class="o">:</span><span class="n">e7</span><span class="o">:</span>
    <span class="n">d0</span><span class="o">:</span><span class="n">e7</span><span class="o">:</span><span class="mi">93</span><span class="o">:</span><span class="n">ee</span><span class="o">:</span><span class="mi">16</span><span class="o">:</span><span class="mi">92</span><span class="o">:</span><span class="mi">23</span><span class="o">:</span><span class="mi">0</span><span class="n">a</span><span class="o">:</span><span class="n">fc</span><span class="o">:</span><span class="mi">95</span><span class="o">:</span><span class="mi">57</span><span class="o">:</span><span class="mi">27</span><span class="o">:</span><span class="mi">5</span><span class="n">c</span><span class="o">:</span><span class="n">bd</span><span class="o">:</span><span class="n">dd</span><span class="o">:</span>
    <span class="mi">7</span><span class="n">b</span><span class="o">:</span><span class="mi">15</span><span class="o">:</span><span class="mi">98</span><span class="o">:</span><span class="mi">7</span><span class="n">a</span><span class="o">:</span><span class="mi">31</span><span class="o">:</span><span class="mi">1</span><span class="n">e</span><span class="o">:</span><span class="mi">58</span><span class="o">:</span><span class="mi">36</span><span class="o">:</span><span class="n">b5</span><span class="o">:</span><span class="mi">9</span><span class="n">c</span><span class="o">:</span><span class="mi">21</span><span class="o">:</span><span class="mi">11</span><span class="o">:</span><span class="n">a8</span><span class="o">:</span><span class="mo">02</span><span class="o">:</span><span class="n">fd</span><span class="o">:</span>
    <span class="n">af</span><span class="o">:</span><span class="n">f7</span><span class="o">:</span><span class="mi">8</span><span class="n">e</span><span class="o">:</span><span class="n">e5</span><span class="o">:</span><span class="mi">09</span><span class="o">:</span><span class="mi">5</span><span class="n">d</span><span class="o">:</span><span class="n">c1</span><span class="o">:</span><span class="mi">28</span><span class="o">:</span><span class="mi">30</span><span class="o">:</span><span class="n">ea</span><span class="o">:</span><span class="mi">6</span><span class="n">b</span><span class="o">:</span><span class="mi">82</span><span class="o">:</span><span class="mi">8</span><span class="n">c</span><span class="o">:</span><span class="n">d0</span><span class="o">:</span><span class="mi">3</span><span class="n">f</span><span class="o">:</span>
    <span class="mo">03</span><span class="o">:</span><span class="n">b7</span><span class="o">:</span><span class="n">a0</span><span class="o">:</span><span class="mi">87</span><span class="o">:</span><span class="mi">3</span><span class="n">d</span><span class="o">:</span><span class="mi">44</span><span class="o">:</span><span class="n">e4</span><span class="o">:</span><span class="n">a4</span><span class="o">:</span><span class="mi">31</span><span class="o">:</span><span class="mi">8</span><span class="n">d</span><span class="o">:</span><span class="mi">89</span><span class="o">:</span><span class="mi">11</span><span class="o">:</span><span class="mi">40</span><span class="o">:</span><span class="mi">62</span><span class="o">:</span><span class="n">dd</span><span class="o">:</span>
    <span class="mi">63</span><span class="o">:</span><span class="mi">1</span><span class="n">f</span><span class="o">:</span><span class="mi">9</span><span class="n">f</span><span class="o">:</span><span class="mi">6</span><span class="n">c</span><span class="o">:</span><span class="mi">2</span><span class="n">d</span><span class="o">:</span><span class="mi">4</span><span class="n">d</span><span class="o">:</span><span class="mi">81</span><span class="o">:</span><span class="n">ee</span>
<span class="n">writing</span> <span class="n">DSA</span> <span class="n">key</span>
<span class="o">-----</span><span class="n">BEGIN</span> <span class="n">DSA</span> <span class="n">PRIVATE</span> <span class="n">KEY</span><span class="o">-----</span>
<span class="n">MIIBuwIBAAKBgQDbXt</span><span class="o">+</span><span class="n">UNxsM2KJGR5q76uqWDgmZKSV3vordjqdwirG</span><span class="o">/</span><span class="n">ukuRkBrg</span>
<span class="mi">0</span><span class="n">p7yWhhd8s</span><span class="o">+</span><span class="n">As</span><span class="o">+</span><span class="n">Q0erzE9mQfyKrqnQjAAxBOT</span><span class="o">/</span><span class="mi">9</span><span class="n">rjH4hvYcgg0H</span><span class="o">/</span><span class="n">uSzWrkRIgZx7</span>
<span class="o">/</span><span class="mi">8</span><span class="n">dFdnOEH</span><span class="o">+</span><span class="n">ORwgQlbxZ</span><span class="o">+</span><span class="n">p1k</span><span class="o">/</span><span class="n">Le4rJh</span><span class="o">/</span><span class="n">dTARRbAjCa</span><span class="o">+</span><span class="n">YkAU9ZL8cGnsQvWQIVAJ8v</span>
<span class="o">+</span><span class="n">YVHYjCApNnLjEBVRTF4kvSpAoGAearp5Wi8BtC77al</span><span class="o">/</span><span class="n">P</span><span class="o">+</span><span class="n">W</span><span class="o">/</span><span class="n">KfxTrp3TmMFwImWG</span>
<span class="o">+</span><span class="n">FqdGVa4poqhYEcFGSaZsrnFZGOwT0PgFLvFCzkz0sfn0OeT7haSIwr8lVcnXL3d</span>
<span class="n">exWYejEeWDa1nCERqAL9r</span><span class="o">/</span><span class="n">eO5QldwSgw6muCjNA</span><span class="o">/</span><span class="n">A7eghz1E5KQxjYkRQGLdYx</span><span class="o">+</span><span class="n">f</span>
<span class="n">bC1Nge4CgYB6o8lSB4HkznXMyVkByLeRo5IE</span><span class="o">+</span><span class="n">IQqKcFtM4kD6d4ZukcI2IUHp7bI</span>
<span class="n">jYSjJNyalYTwPcCMgpWJEseC6Xcf90gR39Sz</span><span class="o">/</span><span class="n">P2</span><span class="o">+</span><span class="n">pWiyCzhJ1CXHlQzwpOIAKuOq</span>
<span class="n">ojwlykrYBZuPuD0Bpo2kUJKyua</span><span class="o">/</span><span class="n">Te1b8cfElVMyr7OrCN0HIBIHovQIVAJbryCYW</span>
<span class="mi">7</span><span class="n">s9I2PGsiuz758FMjZ9Z</span>
<span class="o">-----</span><span class="n">END</span> <span class="n">DSA</span> <span class="n">PRIVATE</span> <span class="n">KEY</span><span class="o">-----</span>
</pre></table></code></div></div><p>priv 和 pub 相当于密钥对中的私钥和公钥，P、Q、G 都是参数文件中的三个关键参数，这是 DSA 算法的关键。</p><p>既然可以查看私钥文件的信息，同理可以查看公钥文件的信息。</p><div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="c1">// 查看公钥和文件的信息</span>
<span class="err">$</span> <span class="n">openssl</span> <span class="n">dsa</span> <span class="o">-</span><span class="n">pubin</span> <span class="o">-</span><span class="n">in</span> <span class="n">dsapublickey</span><span class="p">.</span><span class="n">pem</span> <span class="o">-</span><span class="n">text</span>
</pre></table></code></div></div><p>输出</p><div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
</pre><td class="rouge-code"><pre><span class="n">read</span> <span class="n">DSA</span> <span class="n">key</span>
<span class="n">pub</span><span class="o">:</span>
    <span class="mi">7</span><span class="n">a</span><span class="o">:</span><span class="n">a3</span><span class="o">:</span><span class="n">c9</span><span class="o">:</span><span class="mi">52</span><span class="o">:</span><span class="mo">07</span><span class="o">:</span><span class="mi">81</span><span class="o">:</span><span class="n">e4</span><span class="o">:</span><span class="n">ce</span><span class="o">:</span><span class="mi">75</span><span class="o">:</span><span class="n">cc</span><span class="o">:</span><span class="n">c9</span><span class="o">:</span><span class="mi">59</span><span class="o">:</span><span class="mo">01</span><span class="o">:</span><span class="n">c8</span><span class="o">:</span><span class="n">b7</span><span class="o">:</span>
    <span class="mi">91</span><span class="o">:</span><span class="n">a3</span><span class="o">:</span><span class="mi">92</span><span class="o">:</span><span class="mo">04</span><span class="o">:</span><span class="n">f8</span><span class="o">:</span><span class="mi">84</span><span class="o">:</span><span class="mi">2</span><span class="n">a</span><span class="o">:</span><span class="mi">29</span><span class="o">:</span><span class="n">c1</span><span class="o">:</span><span class="mi">6</span><span class="n">d</span><span class="o">:</span><span class="mi">33</span><span class="o">:</span><span class="mi">89</span><span class="o">:</span><span class="mo">03</span><span class="o">:</span><span class="n">e9</span><span class="o">:</span><span class="n">de</span><span class="o">:</span>
    <span class="mi">19</span><span class="o">:</span><span class="n">ba</span><span class="o">:</span><span class="mi">47</span><span class="o">:</span><span class="mi">08</span><span class="o">:</span><span class="n">d8</span><span class="o">:</span><span class="mi">85</span><span class="o">:</span><span class="mo">07</span><span class="o">:</span><span class="n">a7</span><span class="o">:</span><span class="n">b6</span><span class="o">:</span><span class="n">c8</span><span class="o">:</span><span class="mi">8</span><span class="n">d</span><span class="o">:</span><span class="mi">84</span><span class="o">:</span><span class="n">a3</span><span class="o">:</span><span class="mi">24</span><span class="o">:</span><span class="n">dc</span><span class="o">:</span>
    <span class="mi">9</span><span class="n">a</span><span class="o">:</span><span class="mi">95</span><span class="o">:</span><span class="mi">84</span><span class="o">:</span><span class="n">f0</span><span class="o">:</span><span class="mi">3</span><span class="n">d</span><span class="o">:</span><span class="n">c0</span><span class="o">:</span><span class="mi">8</span><span class="n">c</span><span class="o">:</span><span class="mi">82</span><span class="o">:</span><span class="mi">95</span><span class="o">:</span><span class="mi">89</span><span class="o">:</span><span class="mi">12</span><span class="o">:</span><span class="n">c7</span><span class="o">:</span><span class="mi">82</span><span class="o">:</span><span class="n">e9</span><span class="o">:</span><span class="mi">77</span><span class="o">:</span>
    <span class="mi">1</span><span class="n">f</span><span class="o">:</span><span class="n">f7</span><span class="o">:</span><span class="mi">48</span><span class="o">:</span><span class="mi">11</span><span class="o">:</span><span class="n">df</span><span class="o">:</span><span class="n">d4</span><span class="o">:</span><span class="n">b3</span><span class="o">:</span><span class="n">fc</span><span class="o">:</span><span class="n">fd</span><span class="o">:</span><span class="n">be</span><span class="o">:</span><span class="n">a5</span><span class="o">:</span><span class="mi">68</span><span class="o">:</span><span class="n">b2</span><span class="o">:</span><span class="mi">0</span><span class="n">b</span><span class="o">:</span><span class="mi">38</span><span class="o">:</span>
    <span class="mi">49</span><span class="o">:</span><span class="n">d4</span><span class="o">:</span><span class="mi">25</span><span class="o">:</span><span class="n">c7</span><span class="o">:</span><span class="mi">95</span><span class="o">:</span><span class="mi">0</span><span class="n">c</span><span class="o">:</span><span class="n">f0</span><span class="o">:</span><span class="n">a4</span><span class="o">:</span><span class="n">e2</span><span class="o">:</span><span class="mo">00</span><span class="o">:</span><span class="mi">2</span><span class="n">a</span><span class="o">:</span><span class="n">e3</span><span class="o">:</span><span class="n">aa</span><span class="o">:</span><span class="n">a2</span><span class="o">:</span><span class="mi">3</span><span class="n">c</span><span class="o">:</span>
    <span class="mi">25</span><span class="o">:</span><span class="n">ca</span><span class="o">:</span><span class="mi">4</span><span class="n">a</span><span class="o">:</span><span class="n">d8</span><span class="o">:</span><span class="mo">05</span><span class="o">:</span><span class="mi">9</span><span class="n">b</span><span class="o">:</span><span class="mi">8</span><span class="n">f</span><span class="o">:</span><span class="n">b8</span><span class="o">:</span><span class="mi">3</span><span class="n">d</span><span class="o">:</span><span class="mo">01</span><span class="o">:</span><span class="n">a6</span><span class="o">:</span><span class="mi">8</span><span class="n">d</span><span class="o">:</span><span class="n">a4</span><span class="o">:</span><span class="mi">50</span><span class="o">:</span><span class="mi">92</span><span class="o">:</span>
    <span class="n">b2</span><span class="o">:</span><span class="n">b9</span><span class="o">:</span><span class="n">af</span><span class="o">:</span><span class="n">d3</span><span class="o">:</span><span class="mi">7</span><span class="n">b</span><span class="o">:</span><span class="mi">56</span><span class="o">:</span><span class="n">fc</span><span class="o">:</span><span class="mi">71</span><span class="o">:</span><span class="n">f1</span><span class="o">:</span><span class="mi">25</span><span class="o">:</span><span class="mi">54</span><span class="o">:</span><span class="n">cc</span><span class="o">:</span><span class="n">ab</span><span class="o">:</span><span class="n">ec</span><span class="o">:</span><span class="n">ea</span><span class="o">:</span>
    <span class="n">c2</span><span class="o">:</span><span class="mi">37</span><span class="o">:</span><span class="mi">41</span><span class="o">:</span><span class="n">c8</span><span class="o">:</span><span class="mo">04</span><span class="o">:</span><span class="mi">81</span><span class="o">:</span><span class="n">e8</span><span class="o">:</span><span class="n">bd</span>
<span class="n">P</span><span class="o">:</span>
    <span class="mo">00</span><span class="o">:</span><span class="n">db</span><span class="o">:</span><span class="mi">5</span><span class="n">e</span><span class="o">:</span><span class="n">df</span><span class="o">:</span><span class="mi">94</span><span class="o">:</span><span class="mi">37</span><span class="o">:</span><span class="mi">1</span><span class="n">b</span><span class="o">:</span><span class="mi">0</span><span class="n">c</span><span class="o">:</span><span class="n">d8</span><span class="o">:</span><span class="n">a2</span><span class="o">:</span><span class="mi">46</span><span class="o">:</span><span class="mi">47</span><span class="o">:</span><span class="mi">9</span><span class="n">a</span><span class="o">:</span><span class="n">bb</span><span class="o">:</span><span class="n">ea</span><span class="o">:</span>
    <span class="n">ea</span><span class="o">:</span><span class="mi">96</span><span class="o">:</span><span class="mi">0</span><span class="n">e</span><span class="o">:</span><span class="mi">09</span><span class="o">:</span><span class="mi">99</span><span class="o">:</span><span class="mi">29</span><span class="o">:</span><span class="mi">25</span><span class="o">:</span><span class="mi">77</span><span class="o">:</span><span class="n">be</span><span class="o">:</span><span class="mi">8</span><span class="n">a</span><span class="o">:</span><span class="n">dd</span><span class="o">:</span><span class="mi">8</span><span class="n">e</span><span class="o">:</span><span class="n">a7</span><span class="o">:</span><span class="mi">70</span><span class="o">:</span><span class="mi">8</span><span class="n">a</span><span class="o">:</span>
    <span class="n">b1</span><span class="o">:</span><span class="n">bf</span><span class="o">:</span><span class="n">ba</span><span class="o">:</span><span class="mi">4</span><span class="n">b</span><span class="o">:</span><span class="mi">91</span><span class="o">:</span><span class="mi">90</span><span class="o">:</span><span class="mi">1</span><span class="n">a</span><span class="o">:</span><span class="n">e0</span><span class="o">:</span><span class="n">d2</span><span class="o">:</span><span class="mi">9</span><span class="n">e</span><span class="o">:</span><span class="n">f2</span><span class="o">:</span><span class="mi">5</span><span class="n">a</span><span class="o">:</span><span class="mi">18</span><span class="o">:</span><span class="mi">5</span><span class="n">d</span><span class="o">:</span><span class="n">f2</span><span class="o">:</span>
    <span class="n">cf</span><span class="o">:</span><span class="mi">80</span><span class="o">:</span><span class="n">b3</span><span class="o">:</span><span class="n">e4</span><span class="o">:</span><span class="mi">34</span><span class="o">:</span><span class="mi">7</span><span class="n">a</span><span class="o">:</span><span class="n">bc</span><span class="o">:</span><span class="n">c4</span><span class="o">:</span><span class="n">f6</span><span class="o">:</span><span class="mi">64</span><span class="o">:</span><span class="mi">1</span><span class="n">f</span><span class="o">:</span><span class="n">c8</span><span class="o">:</span><span class="n">aa</span><span class="o">:</span><span class="n">ea</span><span class="o">:</span><span class="mi">9</span><span class="n">d</span><span class="o">:</span>
    <span class="mi">08</span><span class="o">:</span><span class="n">c0</span><span class="o">:</span><span class="mo">03</span><span class="o">:</span><span class="mi">10</span><span class="o">:</span><span class="mi">4</span><span class="n">e</span><span class="o">:</span><span class="mi">4</span><span class="n">f</span><span class="o">:</span><span class="n">ff</span><span class="o">:</span><span class="mi">6</span><span class="n">b</span><span class="o">:</span><span class="mi">8</span><span class="n">c</span><span class="o">:</span><span class="mi">7</span><span class="n">e</span><span class="o">:</span><span class="mi">21</span><span class="o">:</span><span class="n">bd</span><span class="o">:</span><span class="mi">87</span><span class="o">:</span><span class="mi">20</span><span class="o">:</span><span class="mi">83</span><span class="o">:</span>
    <span class="mi">41</span><span class="o">:</span><span class="n">ff</span><span class="o">:</span><span class="n">b9</span><span class="o">:</span><span class="mi">2</span><span class="n">c</span><span class="o">:</span><span class="n">d6</span><span class="o">:</span><span class="n">ae</span><span class="o">:</span><span class="mi">44</span><span class="o">:</span><span class="mi">48</span><span class="o">:</span><span class="mi">81</span><span class="o">:</span><span class="mi">9</span><span class="n">c</span><span class="o">:</span><span class="mi">7</span><span class="n">b</span><span class="o">:</span><span class="n">ff</span><span class="o">:</span><span class="n">c7</span><span class="o">:</span><span class="mi">45</span><span class="o">:</span><span class="mi">76</span><span class="o">:</span>
    <span class="mi">73</span><span class="o">:</span><span class="mi">84</span><span class="o">:</span><span class="mi">1</span><span class="n">f</span><span class="o">:</span><span class="n">e3</span><span class="o">:</span><span class="mi">91</span><span class="o">:</span><span class="n">c2</span><span class="o">:</span><span class="mo">04</span><span class="o">:</span><span class="mi">25</span><span class="o">:</span><span class="mi">6</span><span class="n">f</span><span class="o">:</span><span class="mi">16</span><span class="o">:</span><span class="mi">7</span><span class="n">e</span><span class="o">:</span><span class="n">a7</span><span class="o">:</span><span class="mi">59</span><span class="o">:</span><span class="mi">3</span><span class="n">f</span><span class="o">:</span><span class="mi">2</span><span class="n">d</span><span class="o">:</span>
    <span class="n">ee</span><span class="o">:</span><span class="mi">2</span><span class="n">b</span><span class="o">:</span><span class="mi">26</span><span class="o">:</span><span class="mi">1</span><span class="n">f</span><span class="o">:</span><span class="n">dd</span><span class="o">:</span><span class="mi">4</span><span class="n">c</span><span class="o">:</span><span class="mo">04</span><span class="o">:</span><span class="mi">51</span><span class="o">:</span><span class="mi">6</span><span class="n">c</span><span class="o">:</span><span class="mi">08</span><span class="o">:</span><span class="n">c2</span><span class="o">:</span><span class="mi">6</span><span class="n">b</span><span class="o">:</span><span class="n">e6</span><span class="o">:</span><span class="mi">24</span><span class="o">:</span><span class="mo">01</span><span class="o">:</span>
    <span class="mi">4</span><span class="n">f</span><span class="o">:</span><span class="mi">59</span><span class="o">:</span><span class="mi">2</span><span class="n">f</span><span class="o">:</span><span class="n">c7</span><span class="o">:</span><span class="mo">06</span><span class="o">:</span><span class="mi">9</span><span class="n">e</span><span class="o">:</span><span class="n">c4</span><span class="o">:</span><span class="mi">2</span><span class="n">f</span><span class="o">:</span><span class="mi">59</span>
<span class="n">Q</span><span class="o">:</span>
    <span class="mo">00</span><span class="o">:</span><span class="mi">9</span><span class="n">f</span><span class="o">:</span><span class="mi">2</span><span class="n">f</span><span class="o">:</span><span class="n">f9</span><span class="o">:</span><span class="mi">85</span><span class="o">:</span><span class="mi">47</span><span class="o">:</span><span class="mi">62</span><span class="o">:</span><span class="mi">30</span><span class="o">:</span><span class="mi">80</span><span class="o">:</span><span class="n">a4</span><span class="o">:</span><span class="n">d9</span><span class="o">:</span><span class="n">cb</span><span class="o">:</span><span class="mi">8</span><span class="n">c</span><span class="o">:</span><span class="mi">40</span><span class="o">:</span><span class="mi">55</span><span class="o">:</span>
    <span class="mi">45</span><span class="o">:</span><span class="mi">31</span><span class="o">:</span><span class="mi">78</span><span class="o">:</span><span class="mi">92</span><span class="o">:</span><span class="n">f4</span><span class="o">:</span><span class="n">a9</span>
<span class="n">G</span><span class="o">:</span>
    <span class="mi">79</span><span class="o">:</span><span class="n">aa</span><span class="o">:</span><span class="n">e9</span><span class="o">:</span><span class="n">e5</span><span class="o">:</span><span class="mi">68</span><span class="o">:</span><span class="n">bc</span><span class="o">:</span><span class="mo">06</span><span class="o">:</span><span class="n">d0</span><span class="o">:</span><span class="n">bb</span><span class="o">:</span><span class="n">ed</span><span class="o">:</span><span class="n">a9</span><span class="o">:</span><span class="mi">7</span><span class="n">f</span><span class="o">:</span><span class="mi">3</span><span class="n">f</span><span class="o">:</span><span class="n">e5</span><span class="o">:</span><span class="n">bf</span><span class="o">:</span>
    <span class="mi">29</span><span class="o">:</span><span class="n">fc</span><span class="o">:</span><span class="mi">53</span><span class="o">:</span><span class="n">ae</span><span class="o">:</span><span class="mi">9</span><span class="n">d</span><span class="o">:</span><span class="n">d3</span><span class="o">:</span><span class="mi">98</span><span class="o">:</span><span class="n">c1</span><span class="o">:</span><span class="mi">70</span><span class="o">:</span><span class="mi">22</span><span class="o">:</span><span class="mi">65</span><span class="o">:</span><span class="mi">86</span><span class="o">:</span><span class="n">f8</span><span class="o">:</span><span class="mi">5</span><span class="n">a</span><span class="o">:</span><span class="mi">9</span><span class="n">d</span><span class="o">:</span>
    <span class="mi">19</span><span class="o">:</span><span class="mi">56</span><span class="o">:</span><span class="n">b8</span><span class="o">:</span><span class="n">a6</span><span class="o">:</span><span class="mi">8</span><span class="n">a</span><span class="o">:</span><span class="n">a1</span><span class="o">:</span><span class="mi">60</span><span class="o">:</span><span class="mi">47</span><span class="o">:</span><span class="mo">05</span><span class="o">:</span><span class="mi">19</span><span class="o">:</span><span class="mi">26</span><span class="o">:</span><span class="mi">99</span><span class="o">:</span><span class="n">b2</span><span class="o">:</span><span class="n">b9</span><span class="o">:</span><span class="n">c5</span><span class="o">:</span>
    <span class="mi">64</span><span class="o">:</span><span class="mi">63</span><span class="o">:</span><span class="n">b0</span><span class="o">:</span><span class="mi">4</span><span class="n">f</span><span class="o">:</span><span class="mi">43</span><span class="o">:</span><span class="n">e0</span><span class="o">:</span><span class="mi">14</span><span class="o">:</span><span class="n">bb</span><span class="o">:</span><span class="n">c5</span><span class="o">:</span><span class="mi">0</span><span class="n">b</span><span class="o">:</span><span class="mi">39</span><span class="o">:</span><span class="mi">33</span><span class="o">:</span><span class="n">d2</span><span class="o">:</span><span class="n">c7</span><span class="o">:</span><span class="n">e7</span><span class="o">:</span>
    <span class="n">d0</span><span class="o">:</span><span class="n">e7</span><span class="o">:</span><span class="mi">93</span><span class="o">:</span><span class="n">ee</span><span class="o">:</span><span class="mi">16</span><span class="o">:</span><span class="mi">92</span><span class="o">:</span><span class="mi">23</span><span class="o">:</span><span class="mi">0</span><span class="n">a</span><span class="o">:</span><span class="n">fc</span><span class="o">:</span><span class="mi">95</span><span class="o">:</span><span class="mi">57</span><span class="o">:</span><span class="mi">27</span><span class="o">:</span><span class="mi">5</span><span class="n">c</span><span class="o">:</span><span class="n">bd</span><span class="o">:</span><span class="n">dd</span><span class="o">:</span>
    <span class="mi">7</span><span class="n">b</span><span class="o">:</span><span class="mi">15</span><span class="o">:</span><span class="mi">98</span><span class="o">:</span><span class="mi">7</span><span class="n">a</span><span class="o">:</span><span class="mi">31</span><span class="o">:</span><span class="mi">1</span><span class="n">e</span><span class="o">:</span><span class="mi">58</span><span class="o">:</span><span class="mi">36</span><span class="o">:</span><span class="n">b5</span><span class="o">:</span><span class="mi">9</span><span class="n">c</span><span class="o">:</span><span class="mi">21</span><span class="o">:</span><span class="mi">11</span><span class="o">:</span><span class="n">a8</span><span class="o">:</span><span class="mo">02</span><span class="o">:</span><span class="n">fd</span><span class="o">:</span>
    <span class="n">af</span><span class="o">:</span><span class="n">f7</span><span class="o">:</span><span class="mi">8</span><span class="n">e</span><span class="o">:</span><span class="n">e5</span><span class="o">:</span><span class="mi">09</span><span class="o">:</span><span class="mi">5</span><span class="n">d</span><span class="o">:</span><span class="n">c1</span><span class="o">:</span><span class="mi">28</span><span class="o">:</span><span class="mi">30</span><span class="o">:</span><span class="n">ea</span><span class="o">:</span><span class="mi">6</span><span class="n">b</span><span class="o">:</span><span class="mi">82</span><span class="o">:</span><span class="mi">8</span><span class="n">c</span><span class="o">:</span><span class="n">d0</span><span class="o">:</span><span class="mi">3</span><span class="n">f</span><span class="o">:</span>
    <span class="mo">03</span><span class="o">:</span><span class="n">b7</span><span class="o">:</span><span class="n">a0</span><span class="o">:</span><span class="mi">87</span><span class="o">:</span><span class="mi">3</span><span class="n">d</span><span class="o">:</span><span class="mi">44</span><span class="o">:</span><span class="n">e4</span><span class="o">:</span><span class="n">a4</span><span class="o">:</span><span class="mi">31</span><span class="o">:</span><span class="mi">8</span><span class="n">d</span><span class="o">:</span><span class="mi">89</span><span class="o">:</span><span class="mi">11</span><span class="o">:</span><span class="mi">40</span><span class="o">:</span><span class="mi">62</span><span class="o">:</span><span class="n">dd</span><span class="o">:</span>
    <span class="mi">63</span><span class="o">:</span><span class="mi">1</span><span class="n">f</span><span class="o">:</span><span class="mi">9</span><span class="n">f</span><span class="o">:</span><span class="mi">6</span><span class="n">c</span><span class="o">:</span><span class="mi">2</span><span class="n">d</span><span class="o">:</span><span class="mi">4</span><span class="n">d</span><span class="o">:</span><span class="mi">81</span><span class="o">:</span><span class="n">ee</span>
<span class="n">writing</span> <span class="n">DSA</span> <span class="n">key</span>
<span class="o">-----</span><span class="n">BEGIN</span> <span class="n">PUBLIC</span> <span class="n">KEY</span><span class="o">-----</span>
<span class="n">MIIBtjCCASsGByqGSM44BAEwggEeAoGBANte35Q3GwzYokZHmrvq6pYOCZkpJXe</span><span class="o">+</span>
<span class="n">it2Op3CKsb</span><span class="o">+</span><span class="mi">6</span><span class="n">S5GQGuDSnvJaGF3yz4Cz5DR6vMT2ZB</span><span class="o">/</span><span class="n">IquqdCMADEE5P</span><span class="o">/</span><span class="mi">2u</span><span class="n">MfiG9</span>
<span class="n">hyCDQf</span><span class="o">+</span><span class="mi">5L</span><span class="n">NauREiBnHv</span><span class="o">/</span><span class="n">x0V2c4Qf45HCBCVvFn6nWT8t7ismH91MBFFsCMJr5iQB</span>
<span class="n">T1kvxwaexC9ZAhUAny</span><span class="o">/</span><span class="mi">5</span><span class="n">hUdiMICk2cuMQFVFMXiS9KkCgYB5qunlaLwG0LvtqX8</span><span class="o">/</span>
<span class="mi">5</span><span class="n">b8p</span><span class="o">/</span><span class="n">FOundOYwXAiZYb4Wp0ZVrimiqFgRwUZJpmyucVkY7BPQ</span><span class="o">+</span><span class="n">AUu8ULOTPSx</span><span class="o">+</span><span class="n">fQ</span>
<span class="mi">55</span><span class="n">PuFpIjCvyVVydcvd17FZh6MR5YNrWcIRGoAv2v947lCV3BKDDqa4KM0D8Dt6CH</span>
<span class="n">PUTkpDGNiRFAYt1jH59sLU2B7gOBhAACgYB6o8lSB4HkznXMyVkByLeRo5IE</span><span class="o">+</span><span class="n">IQq</span>
<span class="n">KcFtM4kD6d4ZukcI2IUHp7bIjYSjJNyalYTwPcCMgpWJEseC6Xcf90gR39Sz</span><span class="o">/</span><span class="n">P2</span><span class="o">+</span>
<span class="n">pWiyCzhJ1CXHlQzwpOIAKuOqojwlykrYBZuPuD0Bpo2kUJKyua</span><span class="o">/</span><span class="n">Te1b8cfElVMyr</span>
<span class="mi">7</span><span class="n">OrCN0HIBIHovQ</span><span class="o">==</span>
<span class="o">-----</span><span class="n">END</span> <span class="n">PUBLIC</span> <span class="n">KEY</span><span class="o">-----</span>
</pre></table></code></div></div><p>输出的内容中，pub、P、Q、G 四个参数和私钥输出的内容是一致的。</p><p>最后验证 DSA 签名算法。这里和 RSA 是差不多的</p><div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="c1">// DSA 进行签名</span>
<span class="err">$</span> <span class="n">openssl</span> <span class="n">dgst</span> <span class="o">-</span><span class="n">sha256</span> <span class="o">-</span><span class="n">sign</span> <span class="n">dsaprivatekey</span><span class="p">.</span><span class="n">pem</span> <span class="o">-</span><span class="n">out</span> <span class="n">signature</span><span class="p">.</span><span class="n">txt</span> <span class="n">plain</span><span class="p">.</span><span class="n">txt</span>
</pre></table></code></div></div><p>输出</p><div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="mi">0</span><span class="o">-^</span><span class="n">B</span><span class="o">^</span><span class="n">T</span><span class="o">^</span><span class="n">Q</span><span class="err">É</span><span class="o">:</span><span class="n">w</span><span class="err">Ç</span><span class="o">^</span><span class="n">K</span><span class="o">^</span><span class="n">F</span><span class="o">^</span><span class="n">A</span><span class="err">Æ</span><span class="o">&lt;</span><span class="mi">88</span><span class="o">&gt;</span><span class="err">Ê</span><span class="o">^</span><span class="n">C</span><span class="o">!</span><span class="mi">0</span><span class="n">H</span><span class="err">ø</span><span class="o">&gt;</span><span class="p">,</span><span class="err">$</span><span class="o">^</span><span class="n">W</span><span class="o">^</span><span class="n">B</span><span class="o">^</span><span class="n">U</span><span class="o">^</span><span class="err">@</span><span class="o">&lt;</span><span class="mi">8</span><span class="n">d</span><span class="o">&gt;</span><span class="err">Ù</span><span class="n">y</span>
<span class="o">^</span><span class="err">@</span><span class="n">H</span><span class="o">^</span><span class="n">W</span><span class="o">^</span><span class="n">W</span><span class="o">^</span><span class="n">D</span><span class="err">àø'</span><span class="n">mq</span><span class="err">î</span><span class="n">_</span><span class="err">}</span><span class="o">^</span><span class="n">Y</span><span class="err">¹</span><span class="n">m</span>
</pre></table></code></div></div><p>校验签名</p><div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="c1">// 验证签名</span>
<span class="err">$</span> <span class="n">openssl</span> <span class="n">dgst</span> <span class="o">-</span><span class="n">sha256</span> <span class="o">-</span><span class="n">verify</span> <span class="n">dsapublickey</span><span class="p">.</span><span class="n">pem</span> <span class="o">-</span><span class="n">signature</span> <span class="n">signature</span><span class="p">.</span><span class="n">txt</span> <span class="n">plain</span><span class="p">.</span><span class="n">txt</span>
</pre></table></code></div></div><p>输出</p><div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">Verified</span> <span class="n">OK</span>
</pre></table></code></div></div><p>如果怀疑上面校验是否是真的，我们可以用另外一个文件来验证一下签名，比如换一个 txt</p><div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="c1">// 更换一个 txt 文件再次验证签名</span>
<span class="err">$</span> <span class="n">openssl</span> <span class="n">dgst</span> <span class="o">-</span><span class="n">sha256</span> <span class="o">-</span><span class="n">verify</span> <span class="n">dsapublickey</span><span class="p">.</span><span class="n">pem</span> <span class="o">-</span><span class="n">signature</span> <span class="n">signature</span><span class="p">.</span><span class="n">txt</span> <span class="n">signature</span><span class="p">.</span><span class="n">txt</span>
</pre></table></code></div></div><p>输出</p><div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">Verification</span> <span class="n">Failure</span>
</pre></table></code></div></div><h2 id="十openssl-中的-ecdsa-数字签名">十、OpenSSL 中的 ECDSA 数字签名</h2><p>生成 ECDSA 私钥</p><div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="c1">// 直接生成 ECDSA 私钥，不用预先生成 ECC 参数文件</span>
<span class="err">$</span> <span class="n">openssl</span> <span class="n">ecparam</span> <span class="o">-</span><span class="n">name</span> <span class="n">secp256k1</span> <span class="o">-</span><span class="n">genkey</span> <span class="o">-</span><span class="n">out</span> <span class="n">ecdsa_priv</span><span class="p">.</span><span class="n">pem</span>
</pre></table></code></div></div><p>输出</p><div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="c1">// secp256k1.pem</span>
<span class="o">-----</span><span class="n">BEGIN</span> <span class="n">EC</span> <span class="n">PARAMETERS</span><span class="o">-----</span>
<span class="n">BgUrgQQACg</span><span class="o">==</span>
<span class="o">-----</span><span class="n">END</span> <span class="n">EC</span> <span class="n">PARAMETERS</span><span class="o">-----</span>

<span class="c1">// ecdsa_priv.pem</span>
<span class="o">-----</span><span class="n">BEGIN</span> <span class="n">EC</span> <span class="n">PARAMETERS</span><span class="o">-----</span>
<span class="n">BgUrgQQACg</span><span class="o">==</span>
<span class="o">-----</span><span class="n">END</span> <span class="n">EC</span> <span class="n">PARAMETERS</span><span class="o">-----</span>
<span class="o">-----</span><span class="n">BEGIN</span> <span class="n">EC</span> <span class="n">PRIVATE</span> <span class="n">KEY</span><span class="o">-----</span>
<span class="n">MHQCAQEEIAU0ftIIbLdCROYOZcGcc</span><span class="o">+</span><span class="mi">4</span><span class="n">JjAsTvYI1pH9Ejbx57k1UoAcGBSuBBAAK</span>
<span class="n">oUQDQgAEKNlv9Lyu406</span><span class="o">/</span><span class="n">hmj4r3ZfmtisJUvPThCasMGySrR4mST8LxLeO6NpsmKL</span>
<span class="n">OVSNQgleZw6fu2ktLGFtObKTeu6z9w</span><span class="o">==</span>
<span class="o">-----</span><span class="n">END</span> <span class="n">EC</span> <span class="n">PRIVATE</span> <span class="n">KEY</span><span class="o">-----</span>
</pre></table></code></div></div><p>显示私钥信息</p><div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="c1">// 显示私钥信息</span>
<span class="err">$</span> <span class="n">openssl</span> <span class="n">ec</span> <span class="o">-</span><span class="n">in</span> <span class="n">ecdsa_priv</span><span class="p">.</span><span class="n">pem</span> <span class="o">-</span><span class="n">text</span> <span class="o">-</span><span class="n">noout</span>
</pre></table></code></div></div><p>输出</p><div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre><span class="n">read</span> <span class="n">EC</span> <span class="n">key</span>
<span class="n">Private</span><span class="o">-</span><span class="n">Key</span><span class="o">:</span> <span class="p">(</span><span class="mi">256</span> <span class="n">bit</span><span class="p">)</span>
<span class="n">priv</span><span class="o">:</span>
    <span class="mo">05</span><span class="o">:</span><span class="mi">34</span><span class="o">:</span><span class="mi">7</span><span class="n">e</span><span class="o">:</span><span class="n">d2</span><span class="o">:</span><span class="mi">08</span><span class="o">:</span><span class="mi">6</span><span class="n">c</span><span class="o">:</span><span class="n">b7</span><span class="o">:</span><span class="mi">42</span><span class="o">:</span><span class="mi">44</span><span class="o">:</span><span class="n">e6</span><span class="o">:</span><span class="mi">0</span><span class="n">e</span><span class="o">:</span><span class="mi">65</span><span class="o">:</span><span class="n">c1</span><span class="o">:</span><span class="mi">9</span><span class="n">c</span><span class="o">:</span><span class="mi">73</span><span class="o">:</span>
    <span class="n">ee</span><span class="o">:</span><span class="mi">09</span><span class="o">:</span><span class="mi">8</span><span class="n">c</span><span class="o">:</span><span class="mi">0</span><span class="n">b</span><span class="o">:</span><span class="mi">13</span><span class="o">:</span><span class="n">bd</span><span class="o">:</span><span class="mi">82</span><span class="o">:</span><span class="mi">35</span><span class="o">:</span><span class="n">a4</span><span class="o">:</span><span class="mi">7</span><span class="n">f</span><span class="o">:</span><span class="mi">44</span><span class="o">:</span><span class="mi">8</span><span class="n">d</span><span class="o">:</span><span class="n">bc</span><span class="o">:</span><span class="mi">79</span><span class="o">:</span><span class="n">ee</span><span class="o">:</span>
    <span class="mi">4</span><span class="n">d</span><span class="o">:</span><span class="mi">54</span>
<span class="n">pub</span><span class="o">:</span>
    <span class="mo">04</span><span class="o">:</span><span class="mi">28</span><span class="o">:</span><span class="n">d9</span><span class="o">:</span><span class="mi">6</span><span class="n">f</span><span class="o">:</span><span class="n">f4</span><span class="o">:</span><span class="n">bc</span><span class="o">:</span><span class="n">ae</span><span class="o">:</span><span class="n">e3</span><span class="o">:</span><span class="mi">4</span><span class="n">e</span><span class="o">:</span><span class="n">bf</span><span class="o">:</span><span class="mi">86</span><span class="o">:</span><span class="mi">68</span><span class="o">:</span><span class="n">f8</span><span class="o">:</span><span class="n">af</span><span class="o">:</span><span class="mi">76</span><span class="o">:</span>
    <span class="mi">5</span><span class="n">f</span><span class="o">:</span><span class="mi">9</span><span class="n">a</span><span class="o">:</span><span class="n">d8</span><span class="o">:</span><span class="n">ac</span><span class="o">:</span><span class="mi">25</span><span class="o">:</span><span class="mi">4</span><span class="n">b</span><span class="o">:</span><span class="n">cf</span><span class="o">:</span><span class="mi">4</span><span class="n">e</span><span class="o">:</span><span class="mi">10</span><span class="o">:</span><span class="mi">9</span><span class="n">a</span><span class="o">:</span><span class="n">b0</span><span class="o">:</span><span class="n">c1</span><span class="o">:</span><span class="n">b2</span><span class="o">:</span><span class="mi">4</span><span class="n">a</span><span class="o">:</span><span class="n">b4</span><span class="o">:</span>
    <span class="mi">78</span><span class="o">:</span><span class="mi">99</span><span class="o">:</span><span class="mi">24</span><span class="o">:</span><span class="n">fc</span><span class="o">:</span><span class="mi">2</span><span class="n">f</span><span class="o">:</span><span class="mi">12</span><span class="o">:</span><span class="n">de</span><span class="o">:</span><span class="mi">3</span><span class="n">b</span><span class="o">:</span><span class="n">a3</span><span class="o">:</span><span class="mi">69</span><span class="o">:</span><span class="n">b2</span><span class="o">:</span><span class="mi">62</span><span class="o">:</span><span class="mi">8</span><span class="n">b</span><span class="o">:</span><span class="mi">39</span><span class="o">:</span><span class="mi">54</span><span class="o">:</span>
    <span class="mi">8</span><span class="n">d</span><span class="o">:</span><span class="mi">42</span><span class="o">:</span><span class="mi">09</span><span class="o">:</span><span class="mi">5</span><span class="n">e</span><span class="o">:</span><span class="mi">67</span><span class="o">:</span><span class="mi">0</span><span class="n">e</span><span class="o">:</span><span class="mi">9</span><span class="n">f</span><span class="o">:</span><span class="n">bb</span><span class="o">:</span><span class="mi">69</span><span class="o">:</span><span class="mi">2</span><span class="n">d</span><span class="o">:</span><span class="mi">2</span><span class="n">c</span><span class="o">:</span><span class="mi">61</span><span class="o">:</span><span class="mi">6</span><span class="n">d</span><span class="o">:</span><span class="mi">39</span><span class="o">:</span><span class="n">b2</span><span class="o">:</span>
    <span class="mi">93</span><span class="o">:</span><span class="mi">7</span><span class="n">a</span><span class="o">:</span><span class="n">ee</span><span class="o">:</span><span class="n">b3</span><span class="o">:</span><span class="n">f7</span>
<span class="n">ASN1</span> <span class="n">OID</span><span class="o">:</span> <span class="n">secp256k1</span>
</pre></table></code></div></div><p>从输出信息里面可以看到私钥信息和命名曲线的信息，密钥长度是 256 比特。</p><p>接下来获取公钥。</p><div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="c1">// 提取公钥</span>
<span class="err">$</span> <span class="n">openssl</span> <span class="n">ec</span> <span class="o">-</span><span class="n">in</span> <span class="n">ecdsa_priv</span><span class="p">.</span><span class="n">pem</span> <span class="o">-</span><span class="n">pubout</span> <span class="o">-</span><span class="n">out</span> <span class="n">ecdsa_pub</span><span class="p">.</span><span class="n">pem</span>

<span class="c1">// 显示公钥</span>
<span class="err">$</span> <span class="n">openssl</span> <span class="n">ec</span> <span class="o">-</span><span class="n">in</span> <span class="n">ecdsa_pub</span><span class="p">.</span><span class="n">pem</span> <span class="o">-</span><span class="n">pubin</span> <span class="o">-</span><span class="n">text</span> <span class="o">-</span><span class="n">noout</span>
</pre></table></code></div></div><p>输出</p><div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre><span class="c1">// ecdsa_pub.pem</span>
<span class="o">-----</span><span class="n">BEGIN</span> <span class="n">PUBLIC</span> <span class="n">KEY</span><span class="o">-----</span>
<span class="n">MFYwEAYHKoZIzj0CAQYFK4EEAAoDQgAEKNlv9Lyu406</span><span class="o">/</span><span class="n">hmj4r3ZfmtisJUvPThCa</span>
<span class="n">sMGySrR4mST8LxLeO6NpsmKLOVSNQgleZw6fu2ktLGFtObKTeu6z9w</span><span class="o">==</span>
<span class="o">-----</span><span class="n">END</span> <span class="n">PUBLIC</span> <span class="n">KEY</span><span class="o">-----</span>


<span class="n">read</span> <span class="n">EC</span> <span class="n">key</span>
<span class="n">Public</span><span class="o">-</span><span class="n">Key</span><span class="o">:</span> <span class="p">(</span><span class="mi">256</span> <span class="n">bit</span><span class="p">)</span>
<span class="n">pub</span><span class="o">:</span>
    <span class="mo">04</span><span class="o">:</span><span class="mi">28</span><span class="o">:</span><span class="n">d9</span><span class="o">:</span><span class="mi">6</span><span class="n">f</span><span class="o">:</span><span class="n">f4</span><span class="o">:</span><span class="n">bc</span><span class="o">:</span><span class="n">ae</span><span class="o">:</span><span class="n">e3</span><span class="o">:</span><span class="mi">4</span><span class="n">e</span><span class="o">:</span><span class="n">bf</span><span class="o">:</span><span class="mi">86</span><span class="o">:</span><span class="mi">68</span><span class="o">:</span><span class="n">f8</span><span class="o">:</span><span class="n">af</span><span class="o">:</span><span class="mi">76</span><span class="o">:</span>
    <span class="mi">5</span><span class="n">f</span><span class="o">:</span><span class="mi">9</span><span class="n">a</span><span class="o">:</span><span class="n">d8</span><span class="o">:</span><span class="n">ac</span><span class="o">:</span><span class="mi">25</span><span class="o">:</span><span class="mi">4</span><span class="n">b</span><span class="o">:</span><span class="n">cf</span><span class="o">:</span><span class="mi">4</span><span class="n">e</span><span class="o">:</span><span class="mi">10</span><span class="o">:</span><span class="mi">9</span><span class="n">a</span><span class="o">:</span><span class="n">b0</span><span class="o">:</span><span class="n">c1</span><span class="o">:</span><span class="n">b2</span><span class="o">:</span><span class="mi">4</span><span class="n">a</span><span class="o">:</span><span class="n">b4</span><span class="o">:</span>
    <span class="mi">78</span><span class="o">:</span><span class="mi">99</span><span class="o">:</span><span class="mi">24</span><span class="o">:</span><span class="n">fc</span><span class="o">:</span><span class="mi">2</span><span class="n">f</span><span class="o">:</span><span class="mi">12</span><span class="o">:</span><span class="n">de</span><span class="o">:</span><span class="mi">3</span><span class="n">b</span><span class="o">:</span><span class="n">a3</span><span class="o">:</span><span class="mi">69</span><span class="o">:</span><span class="n">b2</span><span class="o">:</span><span class="mi">62</span><span class="o">:</span><span class="mi">8</span><span class="n">b</span><span class="o">:</span><span class="mi">39</span><span class="o">:</span><span class="mi">54</span><span class="o">:</span>
    <span class="mi">8</span><span class="n">d</span><span class="o">:</span><span class="mi">42</span><span class="o">:</span><span class="mi">09</span><span class="o">:</span><span class="mi">5</span><span class="n">e</span><span class="o">:</span><span class="mi">67</span><span class="o">:</span><span class="mi">0</span><span class="n">e</span><span class="o">:</span><span class="mi">9</span><span class="n">f</span><span class="o">:</span><span class="n">bb</span><span class="o">:</span><span class="mi">69</span><span class="o">:</span><span class="mi">2</span><span class="n">d</span><span class="o">:</span><span class="mi">2</span><span class="n">c</span><span class="o">:</span><span class="mi">61</span><span class="o">:</span><span class="mi">6</span><span class="n">d</span><span class="o">:</span><span class="mi">39</span><span class="o">:</span><span class="n">b2</span><span class="o">:</span>
    <span class="mi">93</span><span class="o">:</span><span class="mi">7</span><span class="n">a</span><span class="o">:</span><span class="n">ee</span><span class="o">:</span><span class="n">b3</span><span class="o">:</span><span class="n">f7</span>
<span class="n">ASN1</span> <span class="n">OID</span><span class="o">:</span> <span class="n">secp256k1</span>
</pre></table></code></div></div><p>生成签名</p><div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="c1">// 选择 sha256 作为 HASH 算法</span>
<span class="err">$</span> <span class="n">openssl</span> <span class="n">dgst</span> <span class="o">-</span><span class="n">sha256</span> <span class="o">-</span><span class="n">sign</span> <span class="n">ecdsa_priv</span><span class="p">.</span><span class="n">pem</span> <span class="o">-</span><span class="n">out</span> <span class="n">signature</span><span class="p">.</span><span class="n">txt</span> <span class="n">plain</span><span class="p">.</span><span class="n">txt</span>
</pre></table></code></div></div><p>输出</p><div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="c1">// signature.txt</span>
<span class="mi">0</span><span class="n">E</span><span class="o">^</span><span class="n">B</span> <span class="n">JTH</span><span class="err">}</span><span class="n">Xi</span><span class="o">&lt;</span><span class="mi">88</span><span class="o">&gt;</span><span class="p">)</span><span class="o">&lt;</span><span class="mi">8</span><span class="n">d</span><span class="o">&gt;</span><span class="err">'È</span><span class="p">;</span><span class="err">þÆß</span><span class="n">e</span><span class="o">&lt;</span><span class="mi">93</span><span class="o">&gt;</span><span class="err">»Õ¦</span><span class="o">|?</span><span class="mi">8</span><span class="o">^</span><span class="err">@</span><span class="o">&lt;</span><span class="mi">84</span><span class="o">&gt;=</span><span class="n">g</span><span class="err">ª</span><span class="n">A</span><span class="p">)</span><span class="n">F</span><span class="o">^</span><span class="n">K</span><span class="o">^</span><span class="n">B</span><span class="o">!^</span><span class="err">@°</span><span class="o">^</span><span class="n">U</span><span class="err">³</span><span class="o">&lt;</span><span class="mi">9</span><span class="n">d</span><span class="o">&gt;</span><span class="n">F</span> <span class="o">&lt;</span><span class="mi">83</span><span class="o">&gt;</span><span class="err">ÐÄµ</span><span class="n">b</span><span class="o">^^&lt;</span><span class="mi">81</span><span class="o">&gt;</span><span class="err">ÿ</span><span class="o">&lt;</span><span class="mi">9</span><span class="n">b</span><span class="o">&gt;</span><span class="n">b</span><span class="o">&lt;</span><span class="mi">92</span><span class="o">&gt;</span><span class="err">Âæ½</span><span class="n">M0</span><span class="p">,</span><span class="s">"W$G,øÑRW</span><span class="err">
</span></pre></table></code></div></div><p>校验签名</p><div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="c1">// 校验签名</span>
<span class="err">$</span> <span class="n">openssl</span> <span class="n">dgst</span> <span class="o">-</span><span class="n">sha256</span> <span class="o">-</span><span class="n">verify</span> <span class="n">ecdsa_pub</span><span class="p">.</span><span class="n">pem</span> <span class="o">-</span><span class="n">signature</span> <span class="n">signature</span><span class="p">.</span><span class="n">txt</span> <span class="n">plain</span><span class="p">.</span><span class="n">txt</span>
</pre></table></code></div></div><p>输出</p><div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">Verified</span> <span class="n">OK</span>
</pre></table></code></div></div><p>如果怀疑上面校验是否是真的，我们可以用另外一个文件来验证一下签名，比如换一个 txt</p><div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="c1">// 更换一个 txt 文件再次验证签名</span>
<span class="err">$</span> <span class="n">openssl</span> <span class="n">dgst</span> <span class="o">-</span><span class="n">sha256</span> <span class="o">-</span><span class="n">verify</span> <span class="n">ecdsa_pub</span><span class="p">.</span><span class="n">pem</span> <span class="o">-</span><span class="n">signature</span> <span class="n">signature</span><span class="p">.</span><span class="n">txt</span> <span class="n">signature</span><span class="p">.</span><span class="n">txt</span>
</pre></table></code></div></div><p>输出</p><div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">Verification</span> <span class="n">Failure</span>
</pre></table></code></div></div><p><strong>DSA 签名算法运算比 RSA 签名运算慢很多，但是 ECDSA 签名算法比 RSA 签名生成快的多，ECDSA 签名验证却比 RSA 签名验证相对慢一些</strong>。</p><p>从安全和速度综合考虑，在 DSA 和 ECDSA 中选一个，优先选择 ECDSA。</p><hr /><p>Reference：</p><p>《图解密码技术》</p></div><div class="post-tail-wrapper text-muted"><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/%E8%83%BD%E5%B7%A5%E5%B7%A7%E5%8C%A0%E9%9B%86/" class="post-tag no-text-decoration" >能工巧匠集</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=密码学的一些探索之数字签名 - idlebook&url=https://idlebook.github.io/posts/10/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=密码学的一些探索之数字签名 - idlebook&u=https://idlebook.github.io/posts/10/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=密码学的一些探索之数字签名 - idlebook&url=https://idlebook.github.io/posts/10/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/003/">Mac命令行科学上网</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/%E8%83%BD%E5%B7%A5%E5%B7%A7%E5%8C%A0%E9%9B%86/">能工巧匠集</a> <a class="post-tag" href="/tags/%E7%AE%97%E6%B3%95/">算法</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/007/"><div class="card-body"> <span class="timeago small" > Oct 15, 2018 <i class="unloaded">2018-10-15T00:00:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>谈谈iOS的一些优化点</h3><div class="text-muted small"><p> 性能优化 卡顿优化 CPU CPU（Central Processing Unit，中央处理器） 对象的创建和销毁 对象属性的调 布局计算 文本的计算和排版 图片的格式转换和解码 图像的绘制（Core Graphics GPU GPU（Graphics...</p></div></div></a></div><div class="card"> <a href="/posts/17/"><div class="card-body"> <span class="timeago small" > Mar 5, 2019 <i class="unloaded">2019-03-05T00:00:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>谈谈Websocket,QQ, 微信,这类IMApp应该怎么做</h3><div class="text-muted small"><p> 目录 1.WebSocket使用场景 2.WebSocket诞生由来 3.谈谈WebSocket协议原理 4.WebSocket 和 Socket的区别与联系 5.iOS平台有哪些WebSocket和Socket的开源框架 6.iOS平台如何实现WebSocket协议 一.WebSocket的使用场景 1.社交聊天 最著名的就是微信，QQ，这一类社...</p></div></div></a></div><div class="card"> <a href="/posts/18/"><div class="card-body"> <span class="timeago small" > Jul 26, 2019 <i class="unloaded">2019-07-26T00:00:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>密码学的一些探索之消息认证码</h3><div class="text-muted small"><p> 一、为什么需要消息认证码？ 还是举一个银行汇钱的例子：A 向 B 汇钱 100 万元。如果攻击者从中攻击，篡改这条消息，就可能变成 A 向攻击者汇钱 1000 万元。这里针对汇款消息，需要注意两个问题：消息的 “完整性” 和 “认证” 。 消息的完整性，就叫消息的一致性，这个可以用上一篇文章中讲的消息指纹来判断，通过对比单向散列函数的 hash 值来判断这条消息的完整性，有没有被...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/18/" class="btn btn-outline-primary"><p>密码学的一些探索之消息认证码</p></a> <a href="/posts/11/" class="btn btn-outline-primary"><p>密码学的一些探索之公钥证书</p></a></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('.post-content img'); const observer = lozad(imgs); observer.observe(); </script><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2021 <a href="https://twitter.com/username">idlebook</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy/" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/%E8%83%BD%E5%B7%A5%E5%B7%A7%E5%8C%A0%E9%9B%86/">能工巧匠集</a> <a class="post-tag" href="/tags/%E7%AE%97%E6%B3%95/">算法</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://idlebook.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script>
